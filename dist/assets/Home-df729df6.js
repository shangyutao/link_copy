import{_ as ue,I as de}from"./index-9d9b4f05.js";/* empty css              */import{u as ve,v as pe,r as me}from"./clipboard-aaacd934.js";/* empty css              */import{K as fe,L as ge,r as n,c as u,a as _e,o as ye,w as he,B as o,C as g,D as t,E as ke,j as d,M as b,N as be,O as w,G as C,P as _,Q as R,F as H,R as W,t as x}from"./vendor-0fdb20b8.js";import{s as r,a as we,B as Te,F as Ie,T as Ce,I as xe,L as Pe}from"./vant-b07c73d6.js";import"./utils-917b1704.js";const Ve=v=>{if(!v||typeof v!="string")return!1;try{return new URL(v),!0}catch{return[/douyin\.com/i,/dy\.com/i,/bilibili\.com/i,/b23\.tv/i,/youtube\.com/i,/youtu\.be/i].some(B=>B.test(v))}},Le=v=>{if(!v)return null;const i=v.toLowerCase();return i.includes("douyin.com")||i.includes("dy.com")?"douyin":i.includes("bilibili.com")||i.includes("b23.tv")?"bilibili":i.includes("youtube.com")||i.includes("youtu.be")?"youtube":i.includes("tiktok.com")?"tiktok":null};const Ne={class:"home-page"},Se={class:"container"},Be={class:"header animate-fade-in-up"},Fe={class:"main-content"},Ae={class:"input-section animate-fade-in-up"},De={class:"input-card card-floating"},Me={class:"input-area"},Ue={class:"input-actions"},ze={key:0,class:"platform-hint"},Ee={key:0,class:"progress-section animate-fade-in-up"},Re={class:"progress-card card-floating"},He={class:"progress-header"},We={class:"progress-icon"},$e={class:"progress-content"},je={key:0,class:"progress-bar-container"},Ge={class:"progress-bar"},Ke={class:"progress-text"},Oe={class:"platforms-section animate-fade-in-up"},Qe={class:"platforms-card card-floating"},qe={class:"platforms-grid"},Je={class:"platform-name"},Xe={class:"features-section animate-fade-in-up"},Ye={class:"features-card card-floating"},Ze={class:"features-grid"},et={class:"feature-icon"},tt={class:"feature-content"},st={__name:"Home",setup(v){const i=fe(),B=ge(),a=ve(),h=n(""),P=n(""),V=n(!1),F=n(!1),A=n(!1),c=n(0),L=n(null),T=n(null),N=n(!1),p=n("desktop"),k=n(null),m=n(!1),M=u(()=>{const e=h.value||"";return typeof e=="string"&&e.trim().length>0&&Ve(e)}),U=u(()=>S.value||V.value||a.isDownloading),z=u(()=>navigator.clipboard&&window.isSecureContext),$=u(()=>a.currentTask&&a.currentTask.status!=="idle"),S=u(()=>{var e;return["pending","downloading","transcribing"].includes((e=a.currentTask)==null?void 0:e.status)}),j=u(()=>{var e;return((e=a.currentTask)==null?void 0:e.status)==="completed"}),G=u(()=>{var e;return((e=a.currentTask)==null?void 0:e.status)==="failed"}),K=u(()=>{if(!a.currentTask)return"";switch(a.currentTask.status){case"pending":return"任务准备中";case"downloading":return"视频解析中";case"transcribing":return"音频转文案中";case"completed":return"处理完成";case"failed":return"处理失败";default:return""}}),O=u(()=>{if(!a.currentTask)return"";switch(a.currentTask.status){case"pending":return"正在创建下载任务...";case"downloading":return"正在下载视频文件...";case"transcribing":return"正在转换音频为文案...";case"completed":return"所有处理步骤已完成";case"failed":return a.currentTask.errorMessage||"处理过程中出现错误";default:return""}}),D=n([{name:"douyin",displayName:"抖音",icon:"music-o",color:"#000000"},{name:"bilibili",displayName:"哔哩哔哩",icon:"video-o",color:"#fb7299"}]),Q=n([{name:"智能解析",description:"自动识别视频平台，快速解析下载链接",icon:"search"},{name:"高清下载",description:"支持多种分辨率，保证视频质量",icon:"down"},{name:"音频转文案",description:"利用AI技术将视频音频转换为文字",icon:"volume-o"},{name:"文案优化",description:"智能优化文案内容，提升可读性",icon:"edit"}]),E=e=>{const s=String(e||"");h.value=s,P.value=Le(s)},q=()=>{},J=()=>{},X=async()=>{if(!z.value){r("当前环境不支持剪贴板操作");return}try{F.value=!0;const e=await me();e?(h.value=e,E(e),r("粘贴成功")):r("剪贴板为空")}catch(e){console.error("粘贴失败:",e),r("粘贴失败")}finally{F.value=!1}},Y=async()=>{if(!M.value){r("请输入有效的视频链接");return}try{V.value=!0,c.value=0;const e=String(h.value||"").trim();if(!e)throw new Error("请输入有效的视频链接");await a.createTask(e),ee(),r("任务创建成功")}catch(e){console.error("创建任务失败:",e),r("创建任务失败: "+e.message)}finally{V.value=!1}},Z=async()=>{try{await we({title:"确认取消",message:"确定要取消当前任务吗？"}),A.value=!0,await a.cancelTask(),I(),r("任务已取消")}catch(e){e!=="cancel"&&(console.error("取消任务失败:",e),r("取消任务失败"))}finally{A.value=!1}},ee=()=>{T.value||(te(),T.value=setInterval(async()=>{var e;if(!((e=a.currentTask)!=null&&e.taskId)){I();return}try{await a.updateTaskStatus(),["completed","failed"].includes(a.currentTask.status)&&(I(),a.currentTask.status==="completed"&&(c.value=100,setTimeout(()=>{i.push(`/preview/${a.currentTask.taskId}`)},500)))}catch(s){console.error("轮询状态失败:",s)}},5e3))},te=()=>{c.value=0,L.value=setInterval(()=>{if(c.value<99){const e=Math.max(.5,(99-c.value)*.1);c.value=Math.min(99,c.value+e)}},200)},se=()=>{L.value&&(clearInterval(L.value),L.value=null)},I=()=>{T.value&&(clearInterval(T.value),T.value=null),se()},ae=()=>{const e=navigator.userAgent.toLowerCase();/iphone|ipad|ipod/.test(e)?p.value="ios":/android/.test(e)?p.value="android":p.value="desktop"},ne=async()=>{if(console.log("🎯 用户点击安装按钮"),console.log("设备类型:",p.value),console.log("是否支持自动安装:",m.value),m.value&&p.value==="android"&&k.value)try{console.log("🚀 执行一键安装"),k.value.prompt();const{outcome:e}=await k.value.userChoice;console.log("用户选择:",e),e==="accepted"?(console.log("✅ 用户接受了安装"),r({message:"安装成功！请在桌面查看应用",type:"success",duration:3e3})):(console.log("❌ 用户拒绝了安装"),r({message:"安装已取消",type:"fail",duration:2e3})),k.value=null,m.value=!1}catch(e){console.error("安装失败:",e),r({message:"安装失败，请手动添加到主屏幕",type:"fail",duration:3e3}),N.value=!0}else console.log("📱 显示安装指引"),N.value=!0},oe=e=>{const s=D.value.find(f=>f.name===e);return(s==null?void 0:s.icon)||"play-circle"},le=e=>{const s=D.value.find(f=>f.name===e);return(s==null?void 0:s.displayName)||e};return _e(()=>{var e;(e=a.currentTask)!=null&&e.taskId&&(console.log("页面刷新，清理之前的任务:",a.currentTask.taskId),pe.cleanTask(a.currentTask.taskId)),ae(),window.addEventListener("beforeinstallprompt",s=>{console.log("🎯 检测到PWA安装提示事件"),s.preventDefault(),k.value=s,m.value=!0,console.log("✅ 支持一键安装功能")}),window.addEventListener("appinstalled",()=>{console.log("🎉 PWA安装完成"),k.value=null,m.value=!1,r({message:"应用安装成功！",type:"success",duration:3e3})})}),ye(()=>{I()}),he(()=>B.path,()=>{I()}),(e,s)=>{const f=Te,re=Ie,y=xe,ie=Ce,ce=Pe;return o(),g("div",Ne,[s[9]||(s[9]=t("div",{class:"bg-decoration"},[t("div",{class:"decoration-circle circle-1"}),t("div",{class:"decoration-circle circle-2"}),t("div",{class:"decoration-circle circle-3"})],-1)),t("div",Se,[t("header",Be,[s[2]||(s[2]=ke('<div class="logo" data-v-7a847287><div class="logo-icon glow-effect" data-v-7a847287><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7a847287><path d="M12 2L2 7v10c0 5.55 3.84 9.74 9 11 5.16-1.26 9-5.45 9-11V7l-10-5z" stroke="currentColor" stroke-width="1.5" fill="none" data-v-7a847287></path><path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="1.5" fill="none" data-v-7a847287></path></svg></div><div class="logo-text" data-v-7a847287><h1 class="gradient-text" data-v-7a847287>Link Copy</h1><p data-v-7a847287>智能视频解析与文案提取</p></div></div>',1)),d(f,{class:be(["install-btn","btn-glass",{"auto-install":m.value&&p.value==="android"}]),icon:m.value&&p.value==="android"?"plus":"wap-home-o",onClick:ne},{default:b(()=>[x(_(m.value&&p.value==="android"?"一键安装":"添加到桌面"),1)]),_:1},8,["class","icon"])]),t("main",Fe,[t("div",Ae,[t("div",De,[s[5]||(s[5]=t("div",{class:"input-header"},[t("h2",null,"粘贴视频链接"),t("p",null,"支持抖音、哔哩哔哩等主流视频平台")],-1)),t("div",Me,[d(re,{modelValue:h.value,"onUpdate:modelValue":[s[0]||(s[0]=l=>h.value=l),E],type:"textarea",placeholder:"在此粘贴视频链接或分享文本...",rows:"3",maxlength:"2000",disabled:U.value,class:"url-input",onFocus:q,onBlur:J},null,8,["modelValue","disabled"]),t("div",Ue,[z.value?(o(),w(f,{key:0,class:"paste-btn btn-glass",icon:"add-o",onClick:X,loading:F.value},{default:b(()=>s[3]||(s[3]=[x(" 粘贴 ")])),_:1,__:[3]},8,["loading"])):C("",!0),d(f,{type:"primary",class:"submit-btn btn-primary",loading:V.value,disabled:!M.value||U.value,onClick:Y},{icon:b(()=>[d(y,{name:"play-circle"})]),default:b(()=>[s[4]||(s[4]=x(" 开始解析 "))]),_:1,__:[4]},8,["loading","disabled"])])]),P.value?(o(),g("div",ze,[d(ie,{type:"primary",class:"platform-tag"},{default:b(()=>[d(y,{name:oe(P.value)},null,8,["name"]),x(" 检测到："+_(le(P.value)),1)]),_:1})])):C("",!0)])]),$.value?(o(),g("div",Ee,[t("div",Re,[t("div",He,[t("div",We,[S.value?(o(),w(ce,{key:0,size:"24px",color:"#667eea"})):j.value?(o(),w(y,{key:1,name:"success",color:"#10b981"})):G.value?(o(),w(y,{key:2,name:"cross",color:"#ef4444"})):(o(),w(y,{key:3,name:"clock-o",color:"#f59e0b"}))]),t("div",$e,[t("h3",null,_(K.value),1),t("p",null,_(O.value),1)]),S.value?(o(),w(f,{key:0,size:"small",type:"danger",plain:"",onClick:Z,loading:A.value},{default:b(()=>s[6]||(s[6]=[x(" 取消 ")])),_:1,__:[6]},8,["loading"])):C("",!0)]),S.value?(o(),g("div",je,[t("div",Ge,[t("div",{class:"progress-fill",style:R({width:c.value+"%"})},null,4)]),t("span",Ke,_(Math.round(c.value))+"%",1)])):C("",!0)])])):C("",!0),t("div",Oe,[t("div",Qe,[s[7]||(s[7]=t("div",{class:"platforms-header"},[t("h3",null,"支持平台"),t("p",null,"持续扩展中，更多平台即将支持")],-1)),t("div",qe,[(o(!0),g(H,null,W(D.value,l=>(o(),g("div",{key:l.name,class:"platform-item"},[t("div",{class:"platform-icon",style:R({color:l.color})},[d(y,{name:l.icon},null,8,["name"])],4),t("span",Je,_(l.displayName),1)]))),128))])])]),t("div",Xe,[t("div",Ye,[s[8]||(s[8]=t("div",{class:"features-header"},[t("h3",null,"功能特性"),t("p",null,"强大的视频处理能力，一站式解决方案")],-1)),t("div",Ze,[(o(!0),g(H,null,W(Q.value,l=>(o(),g("div",{key:l.name,class:"feature-item"},[t("div",et,[d(y,{name:l.icon},null,8,["name"])]),t("div",tt,[t("h4",null,_(l.name),1),t("p",null,_(l.description),1)])]))),128))])])])])]),d(de,{modelValue:N.value,"onUpdate:modelValue":s[1]||(s[1]=l=>N.value=l)},null,8,["modelValue"])])}}},ut=ue(st,[["__scopeId","data-v-7a847287"]]);export{ut as default};
//# sourceMappingURL=Home-df729df6.js.map
