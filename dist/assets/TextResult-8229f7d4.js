import{_ as it}from"./index-8ea1a3a9.js";import{f as nt,b as G}from"./format-bc53a88b.js";/* empty css              *//* empty css              */import{u as lt,c as B}from"./clipboard-431328c5.js";/* empty css              */import{L as rt,K as ct,r as C,c as i,a as ut,o as dt,B as n,C as u,j as a,M as I,D as s,R as vt,N as z,O as l,G as v,u as R,t as m}from"./vendor-194b799d.js";import{s as c,N as mt,P as pt,T as _t,B as It,b as gt,I as ht,L as xt}from"./vant-83faff4e.js";import"./utils-917b1704.js";const ft={class:"text-result-page"},yt={class:"page-content"},Tt={key:0,class:"status-section"},bt={class:"status-content"},kt={class:"status-icon"},wt={class:"status-text"},Mt={key:0,class:"progress-section"},Ct={class:"progress-text"},zt={key:1,class:"video-summary"},jt={class:"summary-card"},Zt={class:"video-thumb"},Wt=["src","alt"],Rt={class:"video-info"},Dt={class:"video-title"},Nt={class:"video-meta"},Gt={class:"duration"},Bt={key:2,class:"text-content-section"},Pt={key:0,class:"text-card original-text"},Et={class:"text-header"},Lt={class:"text-actions"},Ot={class:"text-content"},At={class:"text-footer"},Ht={class:"text-length"},St={class:"text-time"},Yt={key:1,class:"text-card optimized-text"},Qt={class:"text-header"},Xt={class:"text-actions"},Ut={class:"text-content"},Jt={class:"text-footer"},Vt={class:"text-length"},Ft={class:"text-time"},$t={key:2,class:"optimize-section"},Kt={key:3,class:"action-section"},qt={class:"action-buttons"},te={class:"history-section"},ee={key:4,class:"error-section"},se="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDMyMCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMjAiIGhlaWdodD0iMTgwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xMzYgNzJIMTg0VjEwOEgxMzZWNzJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0xNTIgODRWOTZMMTY4IDkwTDE1MiA4NFoiIGZpbGw9IndoaXRlIi8+Cjx0ZXh0IHg9IjE2MCIgeT0iMTMwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjOUI5QjlCIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiPuinhumikea1i+WkseaViTwvdGV4dD4KPC9zdmc+",ae={__name:"TextResult",setup(oe){const P=rt(),j=ct(),d=lt(),f=C(P.params.taskId),Z=C(!1),M=C(""),y=C(0),W=i(()=>d.currentTask),T=i(()=>d.transcriptionData),p=i(()=>d.isTranscribing),b=i(()=>d.isTranscriptionCompleted),k=i(()=>d.isTranscriptionFailed),g=i(()=>{var t;return(t=W.value)==null?void 0:t.videoInfo}),r=i(()=>{var t;return(t=T.value)==null?void 0:t.text}),_=i(()=>{var t;return(t=T.value)==null?void 0:t.optimizedText}),E=i(()=>{var t;return(t=T.value)==null?void 0:t.createTime}),L=i(()=>{var t;return(t=T.value)==null?void 0:t.optimizeTime}),O=i(()=>p.value||!r.value&&!k.value),A=i(()=>p.value?"status-processing":b.value?"status-completed":k.value?"status-failed":"status-pending"),H=i(()=>p.value?"正在转换文案":b.value?"转换完成":k.value?"转换失败":"准备转换"),S=i(()=>p.value?"正在将视频音频转换为文字，请稍候...":b.value?"音频转文案完成，可进行AI优化":k.value?"转换过程中出现错误，请重试":"即将开始音频转文案"),Y=()=>{j.push(`/video-preview/${f.value}`)},Q=()=>{j.push("/history")},X=()=>{j.push("/")},U=async()=>{const t=_.value||r.value;if(!t){c("暂无文案可分享");return}try{navigator.share?await navigator.share({title:"视频文案分享",text:t}):(await B(t),c("文案已复制到剪贴板"))}catch(e){console.error("分享失败:",e),c("分享失败")}},D=async t=>{try{await B(t),c("已复制到剪贴板")}catch{c("复制失败")}},J=async()=>{if(!r.value){c("没有可优化的文案");return}Z.value=!0;try{await d.optimizeText(r.value),c("AI优化完成")}catch{c("优化失败，请重试")}finally{Z.value=!1}},V=async()=>{const t=_.value||r.value;if(!t){c("暂无文案可导出");return}try{const e=new Blob([t],{type:"text/plain;charset=utf-8"}),o=URL.createObjectURL(e),h=document.createElement("a");h.href=o,h.download=`视频文案_${new Date().toISOString().slice(0,10)}.txt`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(o),c("文案已导出")}catch{c("导出失败")}},F=t=>{t.target.src.includes("placeholder-video.jpg")||t.target.src.includes("data:image/svg+xml")||t.target.dataset.errorHandled||(t.target.dataset.errorHandled="true",t.target.src=se)},$=t=>{const e={douyin:"#ff6b6b",bilibili:"#fb7299",youtube:"#ff0000",default:"#666eea"};return e[t]||e.default},K=t=>{const e={douyin:"抖音",bilibili:"哔哩哔哩",youtube:"YouTube",default:"未知平台"};return e[t]||e.default};ut(async()=>{if(!W.value||W.value.taskId!==f.value)try{await d.refreshTaskStatus(f.value)}catch(t){M.value="无法获取任务信息",console.error("获取任务状态失败:",t);return}try{await d.getTranscriptionResult(f.value)}catch(t){console.error("获取转文案结果失败:",t),T.value||(M.value="转文案结果不存在，请重新转换")}p.value&&q()}),dt(()=>{N()});let w=null;const q=()=>{w||(w=setInterval(async()=>{try{await d.getTranscriptionResult(f.value),p.value?y.value=Math.min(y.value+5,95):(y.value=100,N())}catch(t){console.error("轮询转文案状态失败:",t)}},2e3))},N=()=>{w&&(clearInterval(w),w=null)};return(t,e)=>{const o=ht,h=mt,tt=xt,et=pt,st=_t,x=It,at=gt;return n(),u("div",ft,[a(h,{title:"文案结果","left-arrow":"",fixed:"",placeholder:"",class:"nav-bar",onClickLeft:Y},{right:I(()=>[a(o,{name:"share-o",size:"18",onClick:U})]),_:1}),s("div",yt,[O.value?(n(),u("div",Tt,[s("div",{class:vt(["status-card",A.value])},[s("div",bt,[s("div",kt,[p.value?(n(),z(tt,{key:0,size:"24px",color:"white"})):b.value?(n(),z(o,{key:1,name:"checked",size:"24px"})):k.value?(n(),z(o,{key:2,name:"close",size:"24px"})):(n(),z(o,{key:3,name:"volume-o",size:"24px"}))]),s("div",wt,[s("h3",null,l(H.value),1),s("p",null,l(S.value),1)])]),p.value?(n(),u("div",Mt,[a(et,{percentage:y.value,"stroke-width":"6",color:"rgba(255,255,255,0.9)","track-color":"rgba(255,255,255,0.2)"},null,8,["percentage"]),s("span",Ct,l(y.value)+"%",1)])):v("",!0)],2)])):v("",!0),g.value?(n(),u("div",zt,[s("div",jt,[s("div",Zt,[s("img",{src:g.value.thumbnail||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDMyMCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMjAiIGhlaWdodD0iMTgwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xMzYgNzJIMTg0VjEwOEgxMzZWNzJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0xNTIgODRWOTZMMTY4IDkwTDE1MiA4NFoiIGZpbGw9IndoaXRlIi8+Cjx0ZXh0IHg9IjE2MCIgeT0iMTMwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjOUI5QjlCIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiPuinhumikea1i+WkseaViTwvdGV4dD4KPC9zdmc+",alt:g.value.title,onError:F},null,40,Wt)]),s("div",Rt,[s("h3",Dt,l(g.value.title),1),s("div",Nt,[s("span",Gt,l(R(nt)(g.value.duration)),1),a(st,{color:$(g.value.platform)},{default:I(()=>[m(l(K(g.value.platform)),1)]),_:1},8,["color"])])])])])):v("",!0),r.value||_.value?(n(),u("div",Bt,[r.value?(n(),u("div",Pt,[s("div",Et,[s("h3",null,[a(o,{name:"volume-o"}),e[2]||(e[2]=m(" 原始文案 "))]),s("div",Lt,[a(x,{size:"mini",type:"default",onClick:e[0]||(e[0]=ot=>D(r.value))},{default:I(()=>[a(o,{name:"copy"}),e[3]||(e[3]=m(" 复制 "))]),_:1,__:[3]})])]),s("div",Ot,[s("p",null,l(r.value),1)]),s("div",At,[s("span",Ht,l(r.value.length)+" 字",1),s("span",St,l(R(G)(E.value)),1)])])):v("",!0),_.value?(n(),u("div",Yt,[s("div",Qt,[s("h3",null,[a(o,{name:"magic"}),e[4]||(e[4]=m(" AI优化文案 "))]),s("div",Xt,[a(x,{size:"mini",type:"primary",onClick:e[1]||(e[1]=ot=>D(_.value))},{default:I(()=>[a(o,{name:"copy"}),e[5]||(e[5]=m(" 复制 "))]),_:1,__:[5]})])]),s("div",Ut,[s("p",null,l(_.value),1)]),s("div",Jt,[s("span",Vt,l(_.value.length)+" 字",1),s("span",Ft,l(R(G)(L.value)),1)])])):v("",!0),r.value&&!_.value?(n(),u("div",$t,[a(x,{type:"primary",size:"large",class:"optimize-btn",onClick:J,loading:Z.value},{default:I(()=>[a(o,{name:"magic"}),e[6]||(e[6]=m(" AI优化文案 "))]),_:1,__:[6]},8,["loading"]),e[7]||(e[7]=s("p",{class:"optimize-desc"}," 使用AI智能优化文案，让表达更清晰流畅 ",-1))])):v("",!0)])):v("",!0),b.value?(n(),u("div",Kt,[s("div",qt,[a(x,{type:"success",size:"large",class:"action-btn",onClick:V},{default:I(()=>[a(o,{name:"down"}),e[8]||(e[8]=m(" 导出文案 "))]),_:1,__:[8]}),a(x,{type:"primary",size:"large",class:"action-btn",onClick:X},{default:I(()=>[a(o,{name:"plus"}),e[9]||(e[9]=m(" 新建任务 "))]),_:1,__:[9]})])])):v("",!0),s("div",te,[a(x,{type:"default",size:"large",class:"history-btn",onClick:Q},{default:I(()=>[a(o,{name:"records"}),e[10]||(e[10]=m(" 查看历史记录 "))]),_:1,__:[10]})]),M.value?(n(),u("div",ee,[a(at,{type:"danger",text:M.value,"left-icon":"warning-o"},null,8,["text"])])):v("",!0)])])}}},pe=it(ae,[["__scopeId","data-v-c6e51e05"]]);export{pe as default};
//# sourceMappingURL=TextResult-8229f7d4.js.map
