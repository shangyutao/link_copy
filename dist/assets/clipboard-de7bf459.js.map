{"version":3,"file":"clipboard-de7bf459.js","sources":["../../src/services/api.js","../../node_modules/@ffmpeg/ffmpeg/dist/esm/const.js","../../node_modules/@ffmpeg/ffmpeg/dist/esm/types.js","../../src/services/video-compress.js","../../src/services/video.js","../../src/utils/storage.js","../../src/stores/task.js","../../src/utils/clipboard.js"],"sourcesContent":["import axios from 'axios'\nimport { showToast, showLoadingToast, closeToast } from 'vant'\n\n// ç¯å¢ƒé…ç½®\nconst isDevelopment = import.meta.env.DEV\n// ä¼˜å…ˆä½¿ç”¨ç¯å¢ƒå˜é‡ï¼Œä¾¿äºåœ¨ç”Ÿäº§ç¯å¢ƒç»•è¿‡é™æ€ç«™ç‚¹ä»£ç†ç›´è¿åç«¯\nconst API_BASE_URL = import.meta.env.VITE_API_BASE_URL || (isDevelopment \n  ? 'http://47.109.155.18:2222/api'  // å¼€å‘ç¯å¢ƒ\n  : '/api'  // é»˜è®¤ç”Ÿäº§ä¸ºç›¸å¯¹è·¯å¾„ï¼ˆNetlify ä»£ç†ï¼‰\n)\n\nconsole.log('APIç¯å¢ƒé…ç½®:', { isDevelopment, API_BASE_URL })\n\n// åˆ›å»ºaxioså®ä¾‹\nconst api = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 30000,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n})\n\n// è¯·æ±‚æ‹¦æˆªå™¨\napi.interceptors.request.use(\n  config => {\n    // æ˜¾ç¤ºloading\n    if (config.showLoading !== false) {\n      showLoadingToast({\n        message: 'è¯·æ±‚ä¸­...',\n        forbidClick: true,\n        duration: 0\n      })\n    }\n    \n    // è‹¥ä¸ºæ–‡ä»¶ä¸Šä¼ (FormData)ï¼Œç§»é™¤é»˜è®¤çš„ JSON Content-Typeï¼Œäº¤ç»™æµè§ˆå™¨è‡ªåŠ¨è®¾ç½®å¸¦ boundary çš„ multipart/form-data\n    try {\n      if (config.data instanceof FormData && config.headers) {\n        delete config.headers['Content-Type']\n        delete config.headers['content-type']\n      }\n    } catch {}\n    \n    console.log('APIè¯·æ±‚:', config.method?.toUpperCase(), config.url, config.data)\n    return config\n  },\n  error => {\n    closeToast()\n    console.error('è¯·æ±‚é”™è¯¯:', error)\n    return Promise.reject(error)\n  }\n)\n\n// å“åº”æ‹¦æˆªå™¨\napi.interceptors.response.use(\n  response => {\n    closeToast()\n    \n    const { data } = response\n    console.log('APIå“åº”:', response.config.url, data)\n    \n    // æ ¹æ®ä¸šåŠ¡çŠ¶æ€ç å¤„ç†\n    if (data.code && data.code !== 200) {\n      const errorMessage = data.message || 'è¯·æ±‚å¤±è´¥'\n      showToast({\n        type: 'fail',\n        message: errorMessage\n      })\n      return Promise.reject(new Error(errorMessage))\n    }\n    \n    return data\n  },\n  error => {\n    closeToast()\n    \n    console.error('å“åº”é”™è¯¯:', error)\n    \n    let errorMessage = 'ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•'\n    \n    if (error.response) {\n      const { status, data } = error.response\n      \n      switch (status) {\n        case 400:\n          errorMessage = data.message || 'è¯·æ±‚å‚æ•°é”™è¯¯'\n          break\n        case 401:\n          errorMessage = 'æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•'\n          break\n        case 403:\n          errorMessage = 'æ²¡æœ‰æƒé™è®¿é—®'\n          break\n        case 404:\n          errorMessage = 'è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨'\n          break\n        case 408:\n          errorMessage = 'è¯·æ±‚è¶…æ—¶'\n          break\n        case 500:\n          errorMessage = 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'\n          break\n        case 503:\n          errorMessage = 'æœåŠ¡æš‚æ—¶ä¸å¯ç”¨'\n          break\n        default:\n          if (data && data.message) {\n            errorMessage = data.message\n          }\n      }\n    } else if (error.code === 'ECONNABORTED') {\n      errorMessage = 'è¯·æ±‚è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥'\n    } else if (error.message === 'Network Error') {\n      errorMessage = 'ç½‘ç»œè¿æ¥å¼‚å¸¸'\n    }\n    \n    showToast({\n      type: 'fail',\n      message: errorMessage\n    })\n    \n    return Promise.reject(error)\n  }\n)\n\nexport default api\nexport { API_BASE_URL } ","export const MIME_TYPE_JAVASCRIPT = \"text/javascript\";\nexport const MIME_TYPE_WASM = \"application/wasm\";\nexport const CORE_VERSION = \"0.12.9\";\nexport const CORE_URL = `https://unpkg.com/@ffmpeg/core@${CORE_VERSION}/dist/umd/ffmpeg-core.js`;\nexport var FFMessageType;\n(function (FFMessageType) {\n    FFMessageType[\"LOAD\"] = \"LOAD\";\n    FFMessageType[\"EXEC\"] = \"EXEC\";\n    FFMessageType[\"FFPROBE\"] = \"FFPROBE\";\n    FFMessageType[\"WRITE_FILE\"] = \"WRITE_FILE\";\n    FFMessageType[\"READ_FILE\"] = \"READ_FILE\";\n    FFMessageType[\"DELETE_FILE\"] = \"DELETE_FILE\";\n    FFMessageType[\"RENAME\"] = \"RENAME\";\n    FFMessageType[\"CREATE_DIR\"] = \"CREATE_DIR\";\n    FFMessageType[\"LIST_DIR\"] = \"LIST_DIR\";\n    FFMessageType[\"DELETE_DIR\"] = \"DELETE_DIR\";\n    FFMessageType[\"ERROR\"] = \"ERROR\";\n    FFMessageType[\"DOWNLOAD\"] = \"DOWNLOAD\";\n    FFMessageType[\"PROGRESS\"] = \"PROGRESS\";\n    FFMessageType[\"LOG\"] = \"LOG\";\n    FFMessageType[\"MOUNT\"] = \"MOUNT\";\n    FFMessageType[\"UNMOUNT\"] = \"UNMOUNT\";\n})(FFMessageType || (FFMessageType = {}));\n","export var FFFSType;\n(function (FFFSType) {\n    FFFSType[\"MEMFS\"] = \"MEMFS\";\n    FFFSType[\"NODEFS\"] = \"NODEFS\";\n    FFFSType[\"NODERAWFS\"] = \"NODERAWFS\";\n    FFFSType[\"IDBFS\"] = \"IDBFS\";\n    FFFSType[\"WORKERFS\"] = \"WORKERFS\";\n    FFFSType[\"PROXYFS\"] = \"PROXYFS\";\n})(FFFSType || (FFFSType = {}));\n","import { FFmpeg } from '@ffmpeg/ffmpeg'\nimport { fetchFile } from '@ffmpeg/util'\n\nlet ffmpegInstance = null\nlet ffmpegLoadingPromise = null\n\nasync function getFFmpeg() {\n  if (ffmpegInstance) {\n    console.log('âœ… ä½¿ç”¨å·²åŠ è½½çš„ FFmpeg å®ä¾‹')\n    return ffmpegInstance\n  }\n  \n  if (ffmpegLoadingPromise) {\n    console.log('â³ FFmpeg æ­£åœ¨åŠ è½½ä¸­ï¼Œç­‰å¾…...')\n    return ffmpegLoadingPromise\n  }\n  \n  console.log('ğŸš€ å¼€å§‹åŠ è½½ FFmpeg...')\n  ffmpegLoadingPromise = new Promise(async (resolve, reject) => {\n    // æ·»åŠ è¶…æ—¶æœºåˆ¶\n    const timeout = setTimeout(() => {\n      console.error('âŒ FFmpeg åŠ è½½è¶…æ—¶ (30ç§’)')\n      ffmpegLoadingPromise = null\n      reject(new Error('FFmpeg åŠ è½½è¶…æ—¶'))\n    }, 30000)\n    \n    try {\n      const ffmpeg = new FFmpeg()\n      console.log('ğŸ“¦ FFmpeg å®ä¾‹åˆ›å»ºæˆåŠŸ')\n      \n      // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨\n      ffmpeg.on('log', ({ message }) => {\n        console.log('FFmpeg log:', message)\n      })\n      \n      ffmpeg.on('progress', ({ progress, time }) => {\n        console.log(`FFmpeg progress: ${Math.round(progress * 100)}% (time: ${time}s)`)\n      })\n      \n      console.log('ğŸ”„ å¼€å§‹åŠ è½½ FFmpeg æ ¸å¿ƒæ–‡ä»¶...')\n      console.log('ğŸ“¥ å°è¯•ä¸‹è½½æ ¸å¿ƒæ–‡ä»¶...')\n      \n      // å…ˆæµ‹è¯•ç½‘ç»œè¿æ¥\n      try {\n        const testResponse = await fetch('https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd/ffmpeg-core.js', { \n          method: 'HEAD',\n          mode: 'cors'\n        })\n        console.log('âœ… ç½‘ç»œè¿æ¥æµ‹è¯•æˆåŠŸ:', testResponse.status)\n      } catch (networkError) {\n        console.warn('âš ï¸ ç½‘ç»œè¿æ¥æµ‹è¯•å¤±è´¥:', networkError)\n      }\n      \n      await ffmpeg.load({\n        coreURL: 'https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd/ffmpeg-core.js',\n        wasmURL: 'https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd/ffmpeg-core.wasm',\n        workerURL: 'https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd/ffmpeg-core.worker.js'\n      })\n      console.log('âœ… FFmpeg æ ¸å¿ƒæ–‡ä»¶åŠ è½½å®Œæˆ')\n      \n      clearTimeout(timeout)\n      ffmpegInstance = ffmpeg\n      console.log('ğŸ‰ FFmpeg å®Œå…¨åŠ è½½æˆåŠŸ')\n      resolve(ffmpeg)\n    } catch (error) {\n      clearTimeout(timeout)\n      console.error('âŒ FFmpeg åŠ è½½å¤±è´¥:', error)\n      console.error('é”™è¯¯è¯¦æƒ…:', {\n        name: error.name,\n        message: error.message,\n        stack: error.stack\n      })\n      ffmpegInstance = null\n      reject(error)\n    } finally {\n      ffmpegLoadingPromise = null\n    }\n  })\n  \n  return ffmpegLoadingPromise\n}\n\n/**\n * å°†è§†é¢‘è½¬ä¸ºä»…éŸ³é¢‘çš„ MP4ï¼ˆAACï¼‰ï¼Œå¤§å¹…å‡å°ä½“ç§¯\n * - éŸ³é¢‘å‚æ•°ï¼šå•å£°é“ã€48kHzã€64kbps\n * - å¤±è´¥æ—¶æŠ›å‡ºé”™è¯¯ï¼Œè°ƒç”¨æ–¹å¯å›é€€åŸæ–‡ä»¶\n * @param {File} inputFile è§†é¢‘æ–‡ä»¶\n * @returns {Promise<Object>} å‹ç¼©ç»“æœ {file, compressed}\n */\nexport async function transcodeToAudioOnlyMp4(inputFile) {\n  console.log('ğŸ¬ å¼€å§‹å‹ç¼©è§†é¢‘:', {\n    name: inputFile.name,\n    size: inputFile.size,\n    type: inputFile.type\n  })\n  \n  try {\n    const ffmpeg = await getFFmpeg()\n    console.log('âœ… FFmpeg åŠ è½½æˆåŠŸ')\n\n    const inputName = 'input.mp4'\n    const outputName = 'output_audio.mp4'\n\n    console.log('ğŸ“ å†™å…¥è¾“å…¥æ–‡ä»¶...')\n    await ffmpeg.writeFile(inputName, await fetchFile(inputFile))\n    console.log('âœ… è¾“å…¥æ–‡ä»¶å†™å…¥å®Œæˆ')\n\n    console.log('ğŸ”„ å¼€å§‹è½¬ç ...')\n    await ffmpeg.exec([\n      '-i', inputName,\n      '-vn',\n      '-ac', '1',\n      '-ar', '48000',\n      '-b:a', '64k',\n      '-c:a', 'aac',\n      '-movflags', '+faststart',\n      outputName\n    ])\n    console.log('âœ… è½¬ç å®Œæˆ')\n\n    console.log('ğŸ“– è¯»å–è¾“å‡ºæ–‡ä»¶...')\n    const data = await ffmpeg.readFile(outputName)\n    console.log('âœ… è¾“å‡ºæ–‡ä»¶è¯»å–å®Œæˆï¼Œå¤§å°:', data.buffer.byteLength)\n\n    const blob = new Blob([data.buffer], { type: 'video/mp4' })\n    const file = new File([blob], inputFile.name.replace(/\\.[^.]+$/, '') + '_audio.mp4', { type: 'video/mp4' })\n    \n    console.log('ğŸ‰ å‹ç¼©å®Œæˆ:', {\n      originalSize: inputFile.size,\n      newSize: file.size,\n      reduction: Math.round((1 - file.size / inputFile.size) * 100) + '%'\n    })\n\n    // æ¸…ç†\n    try { await ffmpeg.deleteFile(inputName) } catch (e) { console.warn('æ¸…ç†è¾“å…¥æ–‡ä»¶å¤±è´¥:', e) }\n    try { await ffmpeg.deleteFile(outputName) } catch (e) { console.warn('æ¸…ç†è¾“å‡ºæ–‡ä»¶å¤±è´¥:', e) }\n\n    return { file, compressed: true }\n  } catch (error) {\n    console.error('âŒ å‹ç¼©å¤±è´¥:', error)\n    throw error\n  }\n}\n\n/**\n * è‹¥åŸæ–‡ä»¶è¶…è¿‡é˜ˆå€¼ï¼Œåˆ™å°è¯•ä»…éŸ³é¢‘è½¬ç ï¼›å¦åˆ™ç›´æ¥è¿”å›åŸæ–‡ä»¶ã€‚\n * @param {File} inputFile\n * @param {number} thresholdBytes é»˜è®¤ 20MB\n * @returns {Promise<{file: File, compressed: boolean}>}\n */\nexport async function maybeCompressForNetlify(inputFile, thresholdBytes = 20 * 1024 * 1024) {\n  if (!inputFile) throw new Error('æ— æ•ˆæ–‡ä»¶')\n  \n  // ä¸´æ—¶å®Œå…¨ç¦ç”¨å‹ç¼©åŠŸèƒ½\n  console.log('âš ï¸ å‹ç¼©åŠŸèƒ½æš‚æ—¶ç¦ç”¨ï¼Œç›´æ¥ä½¿ç”¨åŸæ–‡ä»¶')\n  console.log('ğŸ“ åŸå› ï¼šFFmpeg æ ¸å¿ƒæ–‡ä»¶åŠ è½½å¤±è´¥')\n  console.log('ğŸ’¡ å»ºè®®ï¼šæ–‡ä»¶å¤§å°è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œè¯·æ‰‹åŠ¨å‹ç¼©åå†ä¸Šä¼ ')\n  console.log('ğŸ“Š æ–‡ä»¶ä¿¡æ¯:', {\n    name: inputFile.name,\n    size: (inputFile.size / (1024 * 1024)).toFixed(2) + 'MB',\n    threshold: (thresholdBytes / (1024 * 1024)).toFixed(2) + 'MB'\n  })\n  \n  return { file: inputFile, compressed: false }\n}\n\n\n","import api from './api'\nimport { maybeCompressForNetlify } from './video-compress'\n\n/**\n * è§†é¢‘ç›¸å…³APIæœåŠ¡\n */\nexport const videoApi = {\n  /**\n   * åˆ›å»ºä¸‹è½½ä»»åŠ¡\n   * @param {string} url - è§†é¢‘é“¾æ¥\n   * @param {string} platform - å¹³å°åç§°ï¼ˆå¯é€‰ï¼‰\n   * @returns {Promise<Object>} ä»»åŠ¡ä¿¡æ¯\n   */\n  async createDownloadTask(url, platform = null) {\n    const response = await api.post('/video/download', {\n      url,\n      platform\n    })\n    return response.data\n  },\n\n  /**\n   * ä¸Šä¼ è§†é¢‘æ–‡ä»¶\n   * @param {File} file - è§†é¢‘æ–‡ä»¶\n   * @param {Function} onProgress - ä¸Šä¼ è¿›åº¦å›è°ƒ\n   * @returns {Promise<Object>} ä»»åŠ¡ä¿¡æ¯\n   */\n  async uploadVideoFile(file, onProgress = null) {\n    // å‚æ•°éªŒè¯\n    if (!file || !(file instanceof File)) {\n      throw new Error('è¯·é€‰æ‹©æœ‰æ•ˆçš„è§†é¢‘æ–‡ä»¶')\n    }\n\n    // æ–‡ä»¶å¤§å°éªŒè¯ï¼ˆ500MBé™åˆ¶ï¼‰\n    const MAX_SIZE = 500 * 1024 * 1024 // 500MB\n    if (file.size > MAX_SIZE) {\n      throw new Error(`æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡500MBï¼Œå½“å‰æ–‡ä»¶å¤§å°ï¼š${this.formatFileSize(file.size)}`)\n    }\n\n    // æ–‡ä»¶ç±»å‹éªŒè¯\n    const supportedTypes = [\n      'video/mp4', 'video/avi', 'video/quicktime', 'video/x-msvideo',\n      'video/x-flv', 'video/webm', 'video/x-matroska', 'video/mp4v-es',\n      'video/3gpp', 'video/ogg'\n    ]\n    \n    const supportedExtensions = [\n      '.mp4', '.avi', '.mov', '.wmv', '.flv', '.webm', '.mkv', '.m4v', '.3gp', '.ogv'\n    ]\n    \n    const fileExtension = file.name.toLowerCase().substring(file.name.lastIndexOf('.'))\n    \n    if (!supportedTypes.includes(file.type) && !supportedExtensions.includes(fileExtension)) {\n      throw new Error('ä¸æ”¯æŒçš„è§†é¢‘æ ¼å¼ï¼Œè¯·ä¸Šä¼  MP4ã€AVIã€MOVã€WMVã€FLVã€WEBMã€MKVã€M4Vã€3GPã€OGV æ ¼å¼çš„è§†é¢‘æ–‡ä»¶')\n    }\n\n    // è‹¥æ–‡ä»¶è¿‡å¤§ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒå°è¯•å‹ç¼©ä¸ºä»…éŸ³é¢‘ MP4ï¼Œé™ä½ä½“ç§¯\n    let uploadFile = file\n    let usedCompressed = false\n    // é»˜è®¤å¯ç”¨å‹ç¼©ï¼ˆæœ¬åœ°ä¸ç”Ÿäº§ä¸€è‡´ï¼‰ï¼Œå¦‚éœ€ç¦ç”¨å¯è®¾ç½® VITE_ENABLE_UPLOAD_COMPRESSION=false\n    const enableCompression = (import.meta.env.VITE_ENABLE_UPLOAD_COMPRESSION !== 'false')\n    const thresholdMb = Number(import.meta.env.VITE_UPLOAD_COMPRESSION_THRESHOLD_MB || 20)\n    const thresholdBytes = Math.max(1, thresholdMb) * 1024 * 1024\n\n    // å…ˆä¸Šä¼ åŸè§†é¢‘ï¼Œåå°è¿›è¡Œå‹ç¼©ï¼ˆé¿å…é˜»å¡ç”¨æˆ·æ“ä½œï¼‰\n    if (enableCompression && file.size > thresholdBytes) {\n      console.log('ğŸ”§ è§¦å‘å‹ç¼©é€»è¾‘:', {\n        fileSize: file.size,\n        thresholdBytes,\n        enableCompression,\n        isDev: import.meta.env.DEV\n      })\n      try {\n        // åå°å‹ç¼©ï¼Œä¸é˜»å¡å½“å‰ä¸Šä¼ \n        maybeCompressForNetlify(file, thresholdBytes).then(({ file: compacted, compressed }) => {\n          if (compressed) {\n            console.log('âœ… åå°å‹ç¼©å®Œæˆï¼Œä¸‹æ¬¡ä¸Šä¼ å°†ä½¿ç”¨å‹ç¼©ç‰ˆæœ¬:', {\n              originalSize: file.size,\n              newSize: compacted.size,\n              reduction: Math.round((1 - compacted.size / file.size) * 100) + '%'\n            })\n            // å¯ä»¥å­˜å‚¨åˆ° localStorage ä¾›ä¸‹æ¬¡ä½¿ç”¨\n            try {\n              const compressedKey = `compressed_${file.name}_${file.size}`\n              localStorage.setItem(compressedKey, JSON.stringify({\n                name: compacted.name,\n                size: compacted.size,\n                timestamp: Date.now()\n              }))\n            } catch (e) {\n              console.warn('å­˜å‚¨å‹ç¼©ä¿¡æ¯å¤±è´¥:', e)\n            }\n          } else {\n            console.log('âš ï¸ å‹ç¼©æœªç”Ÿæ•ˆï¼Œæ–‡ä»¶å¤§å°æœªè¶…è¿‡é˜ˆå€¼æˆ–å‹ç¼©å¤±è´¥')\n          }\n        }).catch(e => {\n          console.warn('âŒ åå°å‹ç¼©å¤±è´¥:', e)\n        })\n      } catch (e) {\n        console.warn('âŒ å¯åŠ¨åå°å‹ç¼©å¤±è´¥:', e)\n      }\n    } else {\n      console.log('â„¹ï¸ è·³è¿‡å‹ç¼©:', {\n        enableCompression,\n        fileSize: file.size,\n        thresholdBytes,\n        reason: !enableCompression ? 'å‹ç¼©å·²ç¦ç”¨' : 'æ–‡ä»¶æœªè¶…è¿‡é˜ˆå€¼'\n      })\n    }\n\n    // ä½¿ç”¨åŸæ–‡ä»¶ä¸Šä¼ \n    uploadFile = file\n\n    // åˆ›å»ºFormData\n    const formData = new FormData()\n    formData.append('video', uploadFile)\n\n    // é…ç½®è¯·æ±‚é€‰é¡¹\n    const config = {\n      // ä¸æ‰‹åŠ¨è®¾ç½® Content-Typeï¼Œäº¤ç»™æµè§ˆå™¨è‡ªåŠ¨ç”Ÿæˆå¸¦ boundary çš„ multipart/form-data\n      timeout: 300000, // 5åˆ†é’Ÿè¶…æ—¶\n      onUploadProgress: (progressEvent) => {\n        if (onProgress && progressEvent.total) {\n          const progress = Math.round((progressEvent.loaded * 100) / progressEvent.total)\n          onProgress(progress)\n        }\n      }\n    }\n\n    // è‹¥å½“å‰ä½¿ç”¨äº†ä»…éŸ³é¢‘å‹ç¼©ï¼Œæ·»åŠ ä¸€ä¸ªæç¤ºæ€§è¯·æ±‚å¤´ï¼ˆä¸å½±å“multipartè‡ªåŠ¨è®¾ç½®ï¼‰\n    if (usedCompressed) {\n      config.headers = {\n        ...(config.headers || {}),\n        'X-Upload-Audio-Only': '1'\n      }\n    }\n\n    try {\n      const response = await api.post('/video/upload', formData, config)\n      return response.data\n    } catch (error) {\n      // å¦‚æœä½¿ç”¨äº†å‹ç¼©æ–‡ä»¶ä¸”åç«¯è¿”å›æ ¼å¼ç›¸å…³é”™è¯¯ï¼Œè‡ªåŠ¨å›é€€ä¸Šä¼ åŸæ–‡ä»¶\n      const status = error?.response?.status\n      const bodyMsg = error?.response?.data?.message || ''\n      const isFormatError = [400, 415, 422].includes(status) || /format|mime|audio|codec/i.test(bodyMsg)\n      if (usedCompressed && isFormatError) {\n        try {\n          const fallbackForm = new FormData()\n          fallbackForm.append('video', file)\n          const resp = await api.post('/video/upload', fallbackForm, config)\n          return resp.data\n        } catch (e) {\n          throw e\n        }\n      }\n      if (error.code === 'ECONNABORTED') {\n        throw new Error('ä¸Šä¼ è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–å°è¯•ä¸Šä¼ æ›´å°çš„æ–‡ä»¶')\n      }\n      if (error.response?.status === 413) {\n        throw new Error('æ–‡ä»¶è¿‡å¤§ï¼Œè¯·ä¸Šä¼ å°äº500MBçš„è§†é¢‘æ–‡ä»¶')\n      }\n      throw error\n    }\n  },\n\n  /**\n   * æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€\n   * @param {string} taskId - ä»»åŠ¡ID\n   * @returns {Promise<Object>} ä»»åŠ¡çŠ¶æ€ä¿¡æ¯\n   */\n  async getTaskStatus(taskId) {\n    const response = await api.get(`/video/status/${taskId}`, {\n      showLoading: false // è½®è¯¢æ—¶ä¸æ˜¾ç¤ºloading\n    })\n    return response.data\n  },\n\n  /**\n   * è·å–è§†é¢‘æ–‡ä»¶ä¸‹è½½é“¾æ¥\n   * @param {string} taskId - ä»»åŠ¡ID\n   * @returns {Promise<string>} ä¸‹è½½é“¾æ¥\n   */\n  async getDownloadUrl(taskId) {\n    // è¿”å›ç›´æ¥ä¸‹è½½é“¾æ¥\n    return `${api.defaults.baseURL}/video/file/${taskId}`\n  },\n\n  /**\n   * æ¸…ç†è§†é¢‘æ–‡ä»¶ï¼ˆç«‹å³åˆ é™¤ï¼‰\n   * @param {string} taskId - ä»»åŠ¡ID\n   * @returns {Promise<Object>} åˆ é™¤ç»“æœ\n   */\n  async cleanVideo(taskId) {\n    const response = await api.delete(`/video/clean/${taskId}`, {\n      showLoading: false // é¿å…æ˜¾ç¤ºloadingï¼Œå› ä¸ºæ¸…ç†æ“ä½œé€šå¸¸åœ¨åå°è¿›è¡Œ\n    })\n    return response.data\n  },\n\n  /**\n   * åˆ é™¤è§†é¢‘æ–‡ä»¶ (å‘åå…¼å®¹)\n   * @param {string} taskId - ä»»åŠ¡ID\n   * @returns {Promise<Object>} åˆ é™¤ç»“æœ\n   */\n  async deleteTask(taskId) {\n    return this.cleanVideo(taskId)\n  },\n\n  /**\n   * è·å–æ”¯æŒçš„å¹³å°åˆ—è¡¨\n   * @returns {Promise<Object>} å¹³å°åˆ—è¡¨\n   */\n  async getSupportedPlatforms() {\n    const response = await api.get('/video/platforms')\n    return response.data\n  },\n\n  /**\n   * è·å–ä»»åŠ¡åˆ—è¡¨\n   * @param {Object} params - æŸ¥è¯¢å‚æ•°\n   * @returns {Promise<Object>} ä»»åŠ¡åˆ—è¡¨\n   */\n  async getTaskList(params = {}) {\n    const response = await api.get('/video/tasks', { params })\n    return response.data\n  },\n\n  /**\n   * è·å–ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯\n   * @returns {Promise<Object>} ç»Ÿè®¡ä¿¡æ¯\n   */\n  async getStats() {\n    const response = await api.get('/video/stats')\n    return response.data\n  },\n\n  /**\n   * æ‰¹é‡æ¸…ç†è¿‡æœŸæ–‡ä»¶\n   * @param {number} hours - è¿‡æœŸå°æ—¶æ•°\n   * @returns {Promise<Object>} æ¸…ç†ç»“æœ\n   */\n  async cleanExpiredFiles(hours = 24) {\n    const response = await api.post('/video/clean/expired', {\n      hours\n    })\n    return response.data\n  },\n\n  /**\n   * é‡è¯•å¤±è´¥ä»»åŠ¡\n   * @param {string} taskId - ä»»åŠ¡ID\n   * @returns {Promise<Object>} é‡è¯•ç»“æœ\n   */\n  async retryTask(taskId) {\n    const response = await api.post(`/video/retry/${taskId}`)\n    return response.data\n  },\n\n  /**\n   * è·å–è§†é¢‘é¢„è§ˆä¿¡æ¯\n   * @param {string} taskId - ä»»åŠ¡ID\n   * @returns {Promise<Object>} é¢„è§ˆä¿¡æ¯\n   */\n  async getVideoPreview(taskId) {\n    const response = await api.get(`/video/preview/${taskId}`)\n    return response\n  },\n\n  /**\n   * è§†é¢‘éŸ³é¢‘è½¬æ–‡æ¡ˆ\n   * @param {string} taskId - ä»»åŠ¡ID\n   * @returns {Promise<Object>} è½¬æ–‡æ¡ˆç»“æœ\n   */\n  async transcribeVideo(taskId) {\n    const response = await api.post(`/video/transcribe/${taskId}`)\n    return response.data\n  },\n\n  /**\n   * AIä¼˜åŒ–æ–‡æ¡ˆ\n   * @param {string} text - åŸå§‹æ–‡æ¡ˆ\n   * @param {Object} options - ä¼˜åŒ–é€‰é¡¹\n   * @returns {Promise<Object>} ä¼˜åŒ–ç»“æœ\n   */\n  async optimizeText(text, options = {}) {\n    // å‚æ•°éªŒè¯\n    if (!text || typeof text !== 'string') {\n      throw new Error('æ–‡æ¡ˆå†…å®¹ä¸èƒ½ä¸ºç©º')\n    }\n    \n    const trimmedText = text.trim()\n    if (trimmedText.length === 0) {\n      throw new Error('æ–‡æ¡ˆå†…å®¹ä¸èƒ½ä¸ºç©º')\n    }\n    \n    // æ£€æŸ¥å­—ç¬¦é•¿åº¦é™åˆ¶\n    const MAX_LENGTH = 10000\n    if (trimmedText.length > MAX_LENGTH) {\n      throw new Error(`æ–‡æ¡ˆé•¿åº¦ä¸èƒ½è¶…è¿‡${MAX_LENGTH}å­—ç¬¦ï¼Œå½“å‰é•¿åº¦ï¼š${trimmedText.length}`)\n    }\n    \n    // è®¾ç½®è¶…æ—¶æ—¶é—´ï¼ˆæ¥å£æ–‡æ¡£è¦æ±‚è‡³å°‘120ç§’ï¼‰\n    const timeout = options.timeout || 120000 // 120ç§’\n    \n    // å¦‚æœæ–‡æ¡ˆè¾ƒé•¿ï¼Œéœ€è¦åˆ†æ®µå¤„ç†\n    const CHUNK_SIZE = 1500\n    if (trimmedText.length > CHUNK_SIZE) {\n      return await this._optimizeTextInChunks(trimmedText, timeout)\n    }\n    \n    // å•æ®µå¤„ç†\n    try {\n      const response = await api.post('/video/optimize-text', {\n        text: trimmedText\n      }, {\n        timeout,\n        showLoading: options.showLoading !== false\n      })\n      return response.data\n    } catch (error) {\n      if (error.code === 'ECONNABORTED' || error.response?.status === 408) {\n        throw new Error('AIä¼˜åŒ–è¯·æ±‚è¶…æ—¶ï¼Œå»ºè®®å°†é•¿æ–‡æ¡ˆåˆ†æ®µæäº¤')\n      }\n      throw error\n    }\n  },\n\n  /**\n   * åˆ†æ®µä¼˜åŒ–æ–‡æ¡ˆï¼ˆç§æœ‰æ–¹æ³•ï¼‰\n   * @param {string} text - åŸå§‹æ–‡æ¡ˆ\n   * @param {number} timeout - è¶…æ—¶æ—¶é—´\n   * @returns {Promise<Object>} ä¼˜åŒ–ç»“æœ\n   */\n  async _optimizeTextInChunks(text, timeout) {\n    const CHUNK_SIZE = 1500\n    const chunks = []\n    \n    // æŒ‰å¥å·ã€é—®å·ã€æ„Ÿå¹å·ç­‰è‡ªç„¶æ–­å¥åˆ†æ®µ\n    const sentences = text.split(/([ã€‚ï¼ï¼Ÿ\\.\\!\\?]+)/)\n    let currentChunk = ''\n    \n    for (let i = 0; i < sentences.length; i++) {\n      const sentence = sentences[i]\n      \n      if (currentChunk.length + sentence.length <= CHUNK_SIZE) {\n        currentChunk += sentence\n      } else {\n        if (currentChunk.trim()) {\n          chunks.push(currentChunk.trim())\n        }\n        currentChunk = sentence\n      }\n    }\n    \n    // æ·»åŠ æœ€åä¸€æ®µ\n    if (currentChunk.trim()) {\n      chunks.push(currentChunk.trim())\n    }\n    \n    // å¦‚æœæ²¡æœ‰åˆé€‚çš„æ–­å¥ï¼Œå¼ºåˆ¶æŒ‰å­—ç¬¦æ•°åˆ†æ®µ\n    if (chunks.length === 1 && chunks[0].length > CHUNK_SIZE) {\n      chunks.length = 0\n      for (let i = 0; i < text.length; i += CHUNK_SIZE) {\n        chunks.push(text.slice(i, i + CHUNK_SIZE))\n      }\n    }\n    \n    console.log(`æ–‡æ¡ˆåˆ†ä¸º${chunks.length}æ®µè¿›è¡Œä¼˜åŒ–`)\n    \n    // é€æ®µä¼˜åŒ–\n    const optimizedChunks = []\n    const errors = []\n    \n    for (let i = 0; i < chunks.length; i++) {\n      try {\n        console.log(`æ­£åœ¨ä¼˜åŒ–ç¬¬${i + 1}/${chunks.length}æ®µ...`)\n        const response = await api.post('/video/optimize-text', {\n          text: chunks[i]\n        }, {\n          timeout,\n          showLoading: false // åˆ†æ®µæ—¶ä¸æ˜¾ç¤ºloadingï¼Œé¿å…é¢‘ç¹å¼¹çª—\n        })\n        \n        optimizedChunks.push(response.data.optimizedText || chunks[i])\n        \n        // åˆ†æ®µä¹‹é—´æ·»åŠ å°å»¶è¿Ÿï¼Œé¿å…è¯·æ±‚è¿‡äºé¢‘ç¹\n        if (i < chunks.length - 1) {\n          await new Promise(resolve => setTimeout(resolve, 1000))\n        }\n      } catch (error) {\n        console.error(`ç¬¬${i + 1}æ®µä¼˜åŒ–å¤±è´¥:`, error)\n        errors.push(`ç¬¬${i + 1}æ®µ: ${error.message}`)\n        optimizedChunks.push(chunks[i]) // ä½¿ç”¨åŸæ–‡\n      }\n    }\n    \n    // åˆå¹¶ç»“æœ\n    const optimizedText = optimizedChunks.join('')\n    \n    return {\n      originalText: text,\n      optimizedText,\n      optimizationTime: new Date().toISOString(),\n      model: 'doubao-seed-1-6-250615',\n      chunks: chunks.length,\n      errors: errors.length > 0 ? errors : undefined\n    }\n  },\n\n  /**\n   * è·å–è½¬æ–‡æ¡ˆç»“æœ\n   * @param {string} taskId - ä»»åŠ¡ID\n   * @returns {Promise<Object>} è½¬æ–‡æ¡ˆç»“æœ\n   */\n  async getTranscriptionResult(taskId) {\n    const response = await api.get(`/video/transcription/${taskId}`, {\n      showLoading: false // è½®è¯¢æ—¶ä¸æ˜¾ç¤ºloading\n    })\n    return response.data\n  },\n\n  /**\n   * è½®è¯¢è·å–è½¬æ–‡æ¡ˆæœ€ç»ˆç»“æœ\n   * @param {string} taskId - ä»»åŠ¡ID\n   * @param {Object} options - é…ç½®é¡¹\n   * @returns {Promise<Object>} è½¬æ–‡æ¡ˆç»“æœ\n   */\n  async pollTranscriptionResult(taskId, { interval = 3000, maxAttempts = 100 } = {}) {\n    let attempts = 0\n    while (attempts < maxAttempts) {\n      try {\n        const res = await this.getTranscriptionResult(taskId)\n        if (res.status === 'completed' || res.transcription?.status === 'completed') {\n          return res\n        }\n        if (res.status === 'failed' || res.transcription?.status === 'failed') {\n          throw new Error(res.errorMessage || res.transcription?.errorMessage || 'è½¬æ–‡æ¡ˆå¤±è´¥')\n        }\n      } catch (error) {\n        // 404 è¡¨ç¤ºç»“æœå°šæœªç”Ÿæˆï¼Œç»§ç»­è½®è¯¢\n        if (error?.response?.status !== 404) {\n          throw error\n        }\n      }\n      await new Promise(resolve => setTimeout(resolve, interval))\n      attempts++\n    }\n    throw new Error('è½¬æ–‡æ¡ˆè¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•')\n  }\n}\n\n/**\n * ä»»åŠ¡è½®è¯¢å™¨ç±»\n */\nexport class TaskPoller {\n  constructor(taskId, onUpdate, options = {}) {\n    this.taskId = taskId\n    this.onUpdate = onUpdate\n    this.options = {\n      interval: 3000, // è½®è¯¢é—´éš”ï¼ˆæ¯«ç§’ï¼‰\n      maxAttempts: 100, // æœ€å¤§å°è¯•æ¬¡æ•°\n      onError: null, // é”™è¯¯å›è°ƒ\n      onComplete: null, // å®Œæˆå›è°ƒ\n      onFailed: null, // å¤±è´¥å›è°ƒ\n      ...options\n    }\n    \n    this.isRunning = false\n    this.attempts = 0\n    this.timer = null\n  }\n\n  /**\n   * å¼€å§‹è½®è¯¢\n   */\n  start() {\n    if (this.isRunning) {\n      return\n    }\n    \n    this.isRunning = true\n    this.attempts = 0\n    this.poll()\n  }\n\n  /**\n   * åœæ­¢è½®è¯¢\n   */\n  stop() {\n    this.isRunning = false\n    this.attempts = 0\n    \n    if (this.timer) {\n      clearTimeout(this.timer)\n      this.timer = null\n    }\n  }\n\n  /**\n   * æ‰§è¡Œè½®è¯¢\n   */\n  async poll() {\n    if (!this.isRunning) {\n      return\n    }\n\n    this.attempts++\n\n    try {\n      const result = await videoApi.getTaskStatus(this.taskId)\n      \n      // è°ƒç”¨æ›´æ–°å›è°ƒ\n      if (this.onUpdate) {\n        this.onUpdate(result)\n      }\n\n      // æ£€æŸ¥ä»»åŠ¡çŠ¶æ€\n      if (result.status === 'completed') {\n        this.stop()\n        if (this.options.onComplete) {\n          this.options.onComplete(result)\n        }\n        return\n      }\n\n      if (result.status === 'failed') {\n        this.stop()\n        if (this.options.onFailed) {\n          this.options.onFailed(result)\n        }\n        return\n      }\n\n      // æ£€æŸ¥æ˜¯å¦è¶…è¿‡æœ€å¤§å°è¯•æ¬¡æ•°\n      if (this.attempts >= this.options.maxAttempts) {\n        this.stop()\n        const error = new Error(`è½®è¯¢è¶…æ—¶ï¼šå·²å°è¯• ${this.attempts} æ¬¡`)\n        if (this.options.onError) {\n          this.options.onError(error)\n        }\n        return\n      }\n\n      // ç»§ç»­è½®è¯¢\n      this.timer = setTimeout(() => {\n        this.poll()\n      }, this.options.interval)\n\n    } catch (error) {\n      console.error('è½®è¯¢ä»»åŠ¡çŠ¶æ€å¤±è´¥:', error)\n      \n      // å¦‚æœæ˜¯ç½‘ç»œé”™è¯¯ï¼Œç»§ç»­å°è¯•\n      if (this.attempts < this.options.maxAttempts) {\n        this.timer = setTimeout(() => {\n          this.poll()\n        }, this.options.interval)\n      } else {\n        this.stop()\n        if (this.options.onError) {\n          this.options.onError(error)\n        }\n      }\n    }\n  }\n}\n\n/**\n * è½¬æ–‡æ¡ˆè½®è¯¢å™¨ç±»\n */\nexport class TranscriptionPoller {\n  constructor(taskId, onUpdate, options = {}) {\n    this.taskId = taskId\n    this.onUpdate = onUpdate\n    this.options = {\n      interval: 2000, // è½®è¯¢é—´éš”ï¼ˆæ¯«ç§’ï¼‰\n      maxAttempts: 150, // æœ€å¤§å°è¯•æ¬¡æ•°ï¼ˆ5åˆ†é’Ÿï¼‰\n      onError: null,\n      onComplete: null,\n      onFailed: null,\n      ...options\n    }\n    \n    this.isRunning = false\n    this.attempts = 0\n    this.timer = null\n  }\n\n  /**\n   * å¼€å§‹è½®è¯¢\n   */\n  start() {\n    if (this.isRunning) {\n      return\n    }\n    \n    this.isRunning = true\n    this.attempts = 0\n    this.poll()\n  }\n\n  /**\n   * åœæ­¢è½®è¯¢\n   */\n  stop() {\n    this.isRunning = false\n    this.attempts = 0\n    \n    if (this.timer) {\n      clearTimeout(this.timer)\n      this.timer = null\n    }\n  }\n\n  /**\n   * æ‰§è¡Œè½®è¯¢\n   */\n  async poll() {\n    if (!this.isRunning) {\n      return\n    }\n\n    this.attempts++\n\n    try {\n      const result = await videoApi.getTranscriptionResult(this.taskId)\n      \n      // è°ƒç”¨æ›´æ–°å›è°ƒ\n      if (this.onUpdate) {\n        this.onUpdate(result)\n      }\n\n      // æ£€æŸ¥è½¬æ–‡æ¡ˆçŠ¶æ€\n      if (result.transcription && result.transcription.status === 'completed') {\n        this.stop()\n        if (this.options.onComplete) {\n          this.options.onComplete(result)\n        }\n        return\n      }\n\n      if (result.transcription && result.transcription.status === 'failed') {\n        this.stop()\n        if (this.options.onFailed) {\n          this.options.onFailed(result)\n        }\n        return\n      }\n\n      // æ£€æŸ¥æ˜¯å¦è¶…è¿‡æœ€å¤§å°è¯•æ¬¡æ•°\n      if (this.attempts >= this.options.maxAttempts) {\n        this.stop()\n        const error = new Error(`è½¬æ–‡æ¡ˆè½®è¯¢è¶…æ—¶ï¼šå·²å°è¯• ${this.attempts} æ¬¡`)\n        if (this.options.onError) {\n          this.options.onError(error)\n        }\n        return\n      }\n\n      // ç»§ç»­è½®è¯¢\n      this.timer = setTimeout(() => {\n        this.poll()\n      }, this.options.interval)\n\n    } catch (error) {\n      console.error('è½®è¯¢è½¬æ–‡æ¡ˆçŠ¶æ€å¤±è´¥:', error)\n      \n      // 404é”™è¯¯å¯èƒ½è¡¨ç¤ºè½¬æ–‡æ¡ˆè¿˜æœªå¼€å§‹æˆ–ä¸å­˜åœ¨\n      if (error.response?.status === 404) {\n        // ç»§ç»­è½®è¯¢\n        if (this.attempts < this.options.maxAttempts) {\n          this.timer = setTimeout(() => {\n            this.poll()\n          }, this.options.interval)\n        } else {\n          this.stop()\n          if (this.options.onError) {\n            this.options.onError(new Error('è½¬æ–‡æ¡ˆä»»åŠ¡ä¸å­˜åœ¨'))\n          }\n        }\n      } else {\n        // å…¶ä»–é”™è¯¯ï¼Œåœæ­¢è½®è¯¢\n        this.stop()\n        if (this.options.onError) {\n          this.options.onError(error)\n        }\n      }\n    }\n  }\n}\n\n/**\n * è§†é¢‘æœåŠ¡å·¥å…·å‡½æ•°\n */\nexport const videoUtils = {\n  /**\n   * æ£€æµ‹è§†é¢‘å¹³å°\n   * @param {string} url - è§†é¢‘é“¾æ¥\n   * @returns {string|null} å¹³å°åç§°\n   */\n  detectPlatform(url) {\n    if (!url) return null\n    \n    const platformMap = {\n      'douyin.com': 'douyin',\n      'dy.com': 'douyin',\n      'bilibili.com': 'bilibili',\n      'b23.tv': 'bilibili',\n      'youtube.com': 'youtube',\n      'youtu.be': 'youtube',\n      'kuaishou.com': 'kuaishou',\n      'ixigua.com': 'ixigua'\n    }\n    \n    for (const [domain, platform] of Object.entries(platformMap)) {\n      if (url.includes(domain)) {\n        return platform\n      }\n    }\n    \n    return null\n  },\n\n  /**\n   * éªŒè¯è§†é¢‘é“¾æ¥\n   * @param {string} url - è§†é¢‘é“¾æ¥\n   * @returns {boolean} æ˜¯å¦æœ‰æ•ˆ\n   */\n  isValidVideoUrl(url) {\n    if (!url || typeof url !== 'string') {\n      return false\n    }\n    \n    // ç®€å•çš„URLéªŒè¯\n    try {\n      new URL(url)\n      return this.detectPlatform(url) !== null\n    } catch {\n      return false\n    }\n  },\n\n  /**\n   * æ¸…ç†è§†é¢‘é“¾æ¥\n   * @param {string} url - åŸå§‹é“¾æ¥\n   * @returns {string} æ¸…ç†åçš„é“¾æ¥\n   */\n  cleanVideoUrl(url) {\n    if (!url) return ''\n    \n    // ç§»é™¤å¤šä½™çš„ç©ºæ ¼å’Œæ¢è¡Œç¬¦\n    url = url.trim().replace(/\\s+/g, ' ')\n    \n    // æå–URL\n    const urlMatch = url.match(/(https?:\\/\\/[^\\s]+)/i)\n    if (urlMatch) {\n      return urlMatch[1]\n    }\n    \n    return url\n  },\n\n  /**\n   * æ ¼å¼åŒ–æ–‡ä»¶å¤§å°\n   * @param {number} bytes - å­—èŠ‚æ•°\n   * @returns {string} æ ¼å¼åŒ–åçš„å¤§å°\n   */\n  formatFileSize(bytes) {\n    if (!bytes) return '0 B'\n    \n    const units = ['B', 'KB', 'MB', 'GB']\n    let size = bytes\n    let unitIndex = 0\n    \n    while (size >= 1024 && unitIndex < units.length - 1) {\n      size /= 1024\n      unitIndex++\n    }\n    \n    return `${size.toFixed(1)} ${units[unitIndex]}`\n  },\n\n  /**\n   * è·å–å¹³å°æ˜¾ç¤ºåç§°\n   * @param {string} platform - å¹³å°ä»£ç \n   * @returns {string} æ˜¾ç¤ºåç§°\n   */\n  getPlatformDisplayName(platform) {\n    const nameMap = {\n      'douyin': 'æŠ–éŸ³',\n      'bilibili': 'å“”å“©å“”å“©',\n      'youtube': 'YouTube',\n      'kuaishou': 'å¿«æ‰‹',\n      'ixigua': 'è¥¿ç“œè§†é¢‘'\n    }\n    \n    return nameMap[platform] || platform || 'æœªçŸ¥å¹³å°'\n  },\n\n  /**\n   * è·å–å¹³å°é¢œè‰²\n   * @param {string} platform - å¹³å°ä»£ç \n   * @returns {string} é¢œè‰²å€¼\n   */\n  getPlatformColor(platform) {\n    const colorMap = {\n      'douyin': '#ff6b6b',\n      'bilibili': '#fb7299',\n      'youtube': '#ff0000',\n      'kuaishou': '#ff6600',\n      'ixigua': '#20b2aa'\n    }\n    \n    return colorMap[platform] || '#666eea'\n  }\n}\n\n/**\n * è§†é¢‘æ¸…ç†ç®¡ç†å™¨\n */\nexport class VideoCleaner {\n  constructor() {\n    this.currentTaskId = null\n    this.shouldCleanOnUnload = true\n    this.setupCleanupListeners()\n  }\n\n  /**\n   * è®¾ç½®å½“å‰ä»»åŠ¡ID\n   * @param {string} taskId - ä»»åŠ¡ID\n   */\n  setCurrentTask(taskId) {\n    // æ¸…ç†ä¹‹å‰çš„ä»»åŠ¡\n    if (this.currentTaskId && this.currentTaskId !== taskId) {\n      this.cleanTask(this.currentTaskId)\n    }\n    this.currentTaskId = taskId\n  }\n\n  /**\n   * æ¸…ç†æŒ‡å®šä»»åŠ¡\n   * @param {string} taskId - ä»»åŠ¡ID\n   */\n  async cleanTask(taskId) {\n    if (!taskId) return\n    \n    try {\n      await videoApi.cleanVideo(taskId)\n      console.log(`å·²æ¸…ç†è§†é¢‘ç¼“å­˜: ${taskId}`)\n    } catch (error) {\n      console.warn(`æ¸…ç†è§†é¢‘ç¼“å­˜å¤±è´¥: ${taskId}`, error)\n    }\n  }\n\n  /**\n   * æ¸…ç†å½“å‰ä»»åŠ¡\n   */\n  async cleanCurrentTask() {\n    if (this.currentTaskId) {\n      await this.cleanTask(this.currentTaskId)\n      this.currentTaskId = null\n    }\n  }\n\n  /**\n   * è®¾ç½®é¡µé¢å¸è½½æ—¶æ˜¯å¦è‡ªåŠ¨æ¸…ç†\n   * @param {boolean} shouldClean - æ˜¯å¦æ¸…ç†\n   */\n  setShouldCleanOnUnload(shouldClean) {\n    this.shouldCleanOnUnload = shouldClean\n  }\n\n  /**\n   * è®¾ç½®æ¸…ç†ç›‘å¬å™¨\n   */\n  setupCleanupListeners() {\n    // é¡µé¢åˆ·æ–°æˆ–å…³é—­æ—¶æ¸…ç†\n    window.addEventListener('beforeunload', () => {\n      if (this.shouldCleanOnUnload && this.currentTaskId) {\n        // ä½¿ç”¨ navigator.sendBeacon ç¡®ä¿æ¸…ç†è¯·æ±‚èƒ½å¤Ÿå‘é€\n        const cleanUrl = `${api.defaults.baseURL}/video/clean/${this.currentTaskId}`\n        navigator.sendBeacon(cleanUrl, JSON.stringify({ method: 'DELETE' }))\n      }\n    })\n\n    // é¡µé¢éšè—æ—¶æ¸…ç†ï¼ˆç§»åŠ¨ç«¯å…¼å®¹ï¼‰\n    document.addEventListener('visibilitychange', () => {\n      if (document.visibilityState === 'hidden' && this.shouldCleanOnUnload && this.currentTaskId) {\n        const cleanUrl = `${api.defaults.baseURL}/video/clean/${this.currentTaskId}`\n        navigator.sendBeacon(cleanUrl, JSON.stringify({ method: 'DELETE' }))\n      }\n    })\n\n    // æµè§ˆå™¨å¯¼èˆªç¦»å¼€æ—¶æ¸…ç†\n    window.addEventListener('pagehide', () => {\n      if (this.shouldCleanOnUnload && this.currentTaskId) {\n        const cleanUrl = `${api.defaults.baseURL}/video/clean/${this.currentTaskId}`\n        navigator.sendBeacon(cleanUrl, JSON.stringify({ method: 'DELETE' }))\n      }\n    })\n  }\n}\n\n// åˆ›å»ºå…¨å±€æ¸…ç†å™¨å®ä¾‹\nexport const videoCleaner = new VideoCleaner() ","// æœ¬åœ°å­˜å‚¨é”®åå¸¸é‡\nexport const STORAGE_KEYS = {\n  TASK_HISTORY: 'link_copy_task_history',\n  USER_SETTINGS: 'link_copy_user_settings',\n  RECENT_PLATFORMS: 'link_copy_recent_platforms'\n}\n\n// å®‰å…¨çš„æœ¬åœ°å­˜å‚¨æ“ä½œ\nexport const storage = {\n  // è·å–æ•°æ®\n  get(key, defaultValue = null) {\n    try {\n      const item = localStorage.getItem(key)\n      return item ? JSON.parse(item) : defaultValue\n    } catch (error) {\n      console.error('è¯»å–æœ¬åœ°å­˜å‚¨å¤±è´¥:', error)\n      return defaultValue\n    }\n  },\n\n  // è®¾ç½®æ•°æ®\n  set(key, value) {\n    try {\n      localStorage.setItem(key, JSON.stringify(value))\n      return true\n    } catch (error) {\n      console.error('ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨å¤±è´¥:', error)\n      return false\n    }\n  },\n\n  // åˆ é™¤æ•°æ®\n  remove(key) {\n    try {\n      localStorage.removeItem(key)\n      return true\n    } catch (error) {\n      console.error('åˆ é™¤æœ¬åœ°å­˜å‚¨å¤±è´¥:', error)\n      return false\n    }\n  },\n\n  // æ¸…ç©ºæ‰€æœ‰æ•°æ®\n  clear() {\n    try {\n      localStorage.clear()\n      return true\n    } catch (error) {\n      console.error('æ¸…ç©ºæœ¬åœ°å­˜å‚¨å¤±è´¥:', error)\n      return false\n    }\n  },\n\n  // è·å–å­˜å‚¨å¤§å°\n  getSize() {\n    try {\n      let total = 0\n      for (let key in localStorage) {\n        if (localStorage.hasOwnProperty(key)) {\n          total += localStorage[key].length + key.length\n        }\n      }\n      return total\n    } catch (error) {\n      console.error('è®¡ç®—å­˜å‚¨å¤§å°å¤±è´¥:', error)\n      return 0\n    }\n  }\n}\n\n// ä»»åŠ¡å†å²ç›¸å…³æ“ä½œ\nexport const taskHistory = {\n  // è·å–å†å²è®°å½•\n  getHistory() {\n    return storage.get(STORAGE_KEYS.TASK_HISTORY, [])\n  },\n\n  // æ·»åŠ åˆ°å†å²è®°å½•\n  addTask(task) {\n    const history = this.getHistory()\n    \n    // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨\n    const existingIndex = history.findIndex(item => item.taskId === task.taskId)\n    \n    if (existingIndex >= 0) {\n      // æ›´æ–°ç°æœ‰è®°å½•\n      history[existingIndex] = { ...history[existingIndex], ...task }\n    } else {\n      // æ·»åŠ æ–°è®°å½•åˆ°å¼€å¤´\n      history.unshift(task)\n    }\n    \n    // é™åˆ¶å†å²è®°å½•æ•°é‡\n    const limitedHistory = history.slice(0, 50)\n    \n    return storage.set(STORAGE_KEYS.TASK_HISTORY, limitedHistory)\n  },\n\n  // æ›´æ–°ä»»åŠ¡\n  updateTask(taskId, updateData) {\n    const history = this.getHistory()\n    const index = history.findIndex(item => item.taskId === taskId)\n    \n    if (index >= 0) {\n      history[index] = { ...history[index], ...updateData }\n      return storage.set(STORAGE_KEYS.TASK_HISTORY, history)\n    }\n    \n    return false\n  },\n\n  // åˆ é™¤ä»»åŠ¡\n  removeTask(taskId) {\n    const history = this.getHistory()\n    const filteredHistory = history.filter(item => item.taskId !== taskId)\n    \n    return storage.set(STORAGE_KEYS.TASK_HISTORY, filteredHistory)\n  },\n\n  // æ¸…ç©ºå†å²è®°å½•\n  clearHistory() {\n    return storage.set(STORAGE_KEYS.TASK_HISTORY, [])\n  }\n}\n\n// ç”¨æˆ·è®¾ç½®ç›¸å…³æ“ä½œ\nexport const userSettings = {\n  // è·å–è®¾ç½®\n  getSettings() {\n    return storage.get(STORAGE_KEYS.USER_SETTINGS, {\n      autoDownload: false,\n      videoQuality: 'high',\n      saveHistory: true,\n      notifications: true\n    })\n  },\n\n  // æ›´æ–°è®¾ç½®\n  updateSettings(newSettings) {\n    const currentSettings = this.getSettings()\n    const updatedSettings = { ...currentSettings, ...newSettings }\n    \n    return storage.set(STORAGE_KEYS.USER_SETTINGS, updatedSettings)\n  },\n\n  // é‡ç½®è®¾ç½®\n  resetSettings() {\n    return storage.remove(STORAGE_KEYS.USER_SETTINGS)\n  }\n} ","import { defineStore } from 'pinia'\nimport { ref, computed } from 'vue'\nimport { videoApi, videoCleaner } from '@/services/video'\nimport { storage, taskHistory as storageTaskHistory } from '@/utils/storage'\n\nexport const useTaskStore = defineStore('task', () => {\n  // å“åº”å¼çŠ¶æ€\n  const currentTask = ref(null)\n  const taskHistory = ref([])\n  const isLoading = ref(false)\n  const isDownloading = ref(false) // ä¸‹è½½çŠ¶æ€\n  const pollingTimer = ref(null)\n  const transcriptionData = ref(null) // è½¬æ–‡æ¡ˆæ•°æ®\n\n  // è®¡ç®—å±æ€§\n  const currentProgress = computed(() => {\n    return currentTask.value?.progress || 0\n  })\n\n  const isProcessing = computed(() => {\n    const status = currentTask.value?.status\n    return status === 'pending' || status === 'downloading'\n  })\n\n  const isCompleted = computed(() => {\n    return currentTask.value?.status === 'completed'\n  })\n\n  const isFailed = computed(() => {\n    return currentTask.value?.status === 'failed'\n  })\n\n  // è½¬æ–‡æ¡ˆç›¸å…³çŠ¶æ€\n  const isTranscribing = computed(() => {\n    return transcriptionData.value?.status === 'processing'\n  })\n\n  const isTranscriptionCompleted = computed(() => {\n    return transcriptionData.value?.status === 'completed'\n  })\n\n  const isTranscriptionFailed = computed(() => {\n    return transcriptionData.value?.status === 'failed'\n  })\n\n  // åŠ¨ä½œæ–¹æ³•\n  \n  /**\n   * åˆ›å»ºä¸‹è½½ä»»åŠ¡\n   */\n  const createTask = async (url, platform = null) => {\n    isLoading.value = true\n    \n    try {\n      // å…ˆæ¸…ç†ä¹‹å‰çš„ä»»åŠ¡\n      await cleanupCurrentTask()\n      \n      const response = await videoApi.createDownloadTask(url, platform)\n      \n      // è®¾ç½®å½“å‰ä»»åŠ¡\n      currentTask.value = {\n        taskId: response.taskId,\n        originalUrl: url,\n        platform: response.platform,\n        status: response.status,\n        progress: 0,\n        createTime: response.createTime,\n        isExisting: response.isExisting\n      }\n      \n      // è®¾ç½®æ¸…ç†å™¨çš„å½“å‰ä»»åŠ¡\n      videoCleaner.setCurrentTask(response.taskId)\n      \n      // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\n      await saveTaskToStorage(currentTask.value)\n      \n      // æ·»åŠ åˆ°å†å²è®°å½•\n      addToHistory(currentTask.value)\n      \n      // å¼€å§‹è½®è¯¢çŠ¶æ€\n      if (isProcessing.value) {\n        startPolling(response.taskId)\n      }\n      \n      return response\n    } catch (error) {\n      console.error('åˆ›å»ºä»»åŠ¡å¤±è´¥:', error)\n      throw error\n    } finally {\n      isLoading.value = false\n    }\n  }\n\n  /**\n   * åˆ›å»ºæ–‡ä»¶ä¸Šä¼ ä»»åŠ¡\n   */\n  const createUploadTask = async (file, onProgress = null) => {\n    isLoading.value = true\n    \n    try {\n      // å…ˆæ¸…ç†ä¹‹å‰çš„ä»»åŠ¡\n      await cleanupCurrentTask()\n      \n      const response = await videoApi.uploadVideoFile(file, onProgress)\n      \n      // è®¾ç½®å½“å‰ä»»åŠ¡\n      currentTask.value = {\n        taskId: response.taskId,\n        originalFile: file,\n        fileName: file.name,\n        fileSize: file.size,\n        platform: 'upload', // æ ‡è®°ä¸ºä¸Šä¼ ç±»å‹\n        status: response.status,\n        progress: 0,\n        createTime: response.createTime || new Date().toISOString(),\n        isExisting: response.isExisting || false\n      }\n      \n      // è®¾ç½®æ¸…ç†å™¨çš„å½“å‰ä»»åŠ¡\n      videoCleaner.setCurrentTask(response.taskId)\n      \n      // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ï¼ˆä¸ä¿å­˜æ–‡ä»¶å¯¹è±¡ï¼‰\n      const taskForStorage = {\n        ...currentTask.value,\n        originalFile: null // ä¸ä¿å­˜æ–‡ä»¶å¯¹è±¡åˆ°localStorage\n      }\n      await saveTaskToStorage(taskForStorage)\n      \n      // æ·»åŠ åˆ°å†å²è®°å½•\n      addToHistory(taskForStorage)\n      \n      // å¼€å§‹è½®è¯¢çŠ¶æ€\n      if (isProcessing.value) {\n        startPolling(response.taskId)\n      }\n      \n      return response\n    } catch (error) {\n      console.error('åˆ›å»ºä¸Šä¼ ä»»åŠ¡å¤±è´¥:', error)\n      throw error\n    } finally {\n      isLoading.value = false\n    }\n  }\n\n  /**\n   * åˆ·æ–°ä»»åŠ¡çŠ¶æ€\n   */\n  const refreshTaskStatus = async (taskId) => {\n    try {\n      const response = await videoApi.getTaskStatus(taskId)\n      console.log('APIè¿”å›çš„ä»»åŠ¡çŠ¶æ€:', response)\n      \n      // APIå“åº”ç»“æ„ï¼š{code: 200, message: \"æŸ¥è¯¢æˆåŠŸ\", data: {...}}\n      // APIæ‹¦æˆªå™¨è¿”å›response.dataï¼Œå³{code, message, data}\n      // æˆ‘ä»¬éœ€è¦çš„å®é™…ä»»åŠ¡æ•°æ®åœ¨response.dataå­—æ®µä¸­\n      const taskData = response.data || response\n      \n      console.log('æå–çš„ä»»åŠ¡æ•°æ®:', taskData)\n      console.log('ä»»åŠ¡è¿›åº¦:', taskData.progress)\n      \n      // æ›´æ–°å½“å‰ä»»åŠ¡çŠ¶æ€\n      if (currentTask.value && currentTask.value.taskId === taskId) {\n        currentTask.value = {\n          ...currentTask.value,\n          ...taskData,\n          updateTime: new Date().toISOString()\n        }\n        \n        console.log('æ›´æ–°åçš„ä»»åŠ¡çŠ¶æ€:', currentTask.value)\n        \n        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\n        await saveTaskToStorage(currentTask.value)\n        \n        // æ›´æ–°å†å²è®°å½•\n        updateHistoryItem(currentTask.value)\n      } else if (!currentTask.value) {\n        // å¦‚æœæ²¡æœ‰å½“å‰ä»»åŠ¡ï¼Œåˆ›å»ºä¸€ä¸ª\n        currentTask.value = {\n          ...taskData,\n          updateTime: new Date().toISOString()\n        }\n        \n        console.log('åˆ›å»ºçš„å½“å‰ä»»åŠ¡:', currentTask.value)\n        \n        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\n        await saveTaskToStorage(currentTask.value)\n        \n        // æ·»åŠ åˆ°å†å²è®°å½•\n        addToHistory(currentTask.value)\n      }\n      \n      return response\n    } catch (error) {\n      console.error('åˆ·æ–°ä»»åŠ¡çŠ¶æ€å¤±è´¥:', error)\n      throw error\n    }\n  }\n\n  /**\n   * æ›´æ–°ä»»åŠ¡çŠ¶æ€ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼Œç”¨äºæ‰‹åŠ¨æ›´æ–°ï¼‰\n   */\n  const updateTaskStatus = async () => {\n    if (currentTask.value?.taskId) {\n      return await refreshTaskStatus(currentTask.value.taskId)\n    }\n  }\n\n  /**\n   * æ›´æ–°å½“å‰ä»»åŠ¡çš„å±æ€§\n   */\n  const updateCurrentTask = (updates) => {\n    if (currentTask.value) {\n      currentTask.value = {\n        ...currentTask.value,\n        ...updates,\n        updateTime: new Date().toISOString()\n      }\n      \n      // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\n      saveTaskToStorage(currentTask.value)\n      \n      // æ›´æ–°å†å²è®°å½•\n      updateHistoryItem(currentTask.value)\n    }\n  }\n\n  /**\n   * å¼€å§‹è½®è¯¢ä»»åŠ¡çŠ¶æ€\n   */\n  const startPolling = (taskId) => {\n    // å…ˆåœæ­¢ä¹‹å‰çš„è½®è¯¢\n    stopPolling()\n    \n    pollingTimer.value = setInterval(async () => {\n      try {\n        await refreshTaskStatus(taskId)\n        \n        // å¦‚æœä»»åŠ¡å®Œæˆæˆ–å¤±è´¥ï¼Œåœæ­¢è½®è¯¢\n        if (!isProcessing.value) {\n          stopPolling()\n        }\n      } catch (error) {\n        console.error('è½®è¯¢ä»»åŠ¡çŠ¶æ€å¤±è´¥:', error)\n        // è½®è¯¢å¤±è´¥ä¹Ÿåœæ­¢è½®è¯¢\n        stopPolling()\n      }\n    }, 5000) // æ¯5ç§’è½®è¯¢ä¸€æ¬¡\n  }\n\n  /**\n   * åœæ­¢è½®è¯¢\n   */\n  const stopPolling = () => {\n    if (pollingTimer.value) {\n      clearInterval(pollingTimer.value)\n      pollingTimer.value = null\n    }\n  }\n\n  /**\n   * ä¸‹è½½è§†é¢‘æ–‡ä»¶\n   */\n  const downloadVideo = async (taskId) => {\n    isDownloading.value = true\n    try {\n      const downloadUrl = await videoApi.getDownloadUrl(taskId)\n      \n      // åˆ›å»ºä¸‹è½½é“¾æ¥\n      const link = document.createElement('a')\n      link.href = downloadUrl\n      link.download = `video_${taskId}.mp4`\n      document.body.appendChild(link)\n      link.click()\n      document.body.removeChild(link)\n      \n      return true\n    } catch (error) {\n      console.error('ä¸‹è½½è§†é¢‘å¤±è´¥:', error)\n      throw error\n    } finally {\n      isDownloading.value = false\n    }\n  }\n\n  /**\n   * è½¬æ¢è§†é¢‘ä¸ºæ–‡æ¡ˆ\n   */\n  const transcribeVideo = async (taskId) => {\n    try {\n      // è®¾ç½®è½¬æ¢çŠ¶æ€\n      transcriptionData.value = {\n        taskId,\n        status: 'processing',\n        progress: 0,\n        createTime: new Date().toISOString()\n      }\n\n      // 1. æäº¤è½¬æ–‡æ¡ˆä»»åŠ¡ï¼ˆåç«¯åº”ç«‹å³è¿”å›å¤„ç†ä¸­ï¼‰\n      await videoApi.transcribeVideo(taskId)\n      // 2. è½®è¯¢è·å–æœ€ç»ˆç»“æœ\n      const result = await videoApi.pollTranscriptionResult(taskId)\n\n      // æ›´æ–°è½¬æ–‡æ¡ˆæ•°æ®\n      transcriptionData.value = {\n        ...transcriptionData.value,\n        ...result,\n        status: 'completed'\n      }\n      return result\n    } catch (error) {\n      // è®¾ç½®å¤±è´¥çŠ¶æ€\n      if (transcriptionData.value) {\n        transcriptionData.value.status = 'failed'\n        transcriptionData.value.errorMessage = error.message\n      }\n      console.error('è½¬æ¢è§†é¢‘ä¸ºæ–‡æ¡ˆå¤±è´¥:', error)\n      throw error\n    }\n  }\n\n  /**\n   * è·å–è½¬æ–‡æ¡ˆç»“æœ\n   */\n  const getTranscriptionResult = async (taskId) => {\n    try {\n      const response = await videoApi.getTranscriptionResult(taskId)\n      \n      // æ›´æ–°è½¬æ–‡æ¡ˆæ•°æ®\n      transcriptionData.value = {\n        ...transcriptionData.value,\n        ...response.transcription,\n        videoInfo: response.videoInfo\n      }\n      \n      return response\n    } catch (error) {\n      console.error('è·å–è½¬æ–‡æ¡ˆç»“æœå¤±è´¥:', error)\n      throw error\n    }\n  }\n\n  /**\n   * AIä¼˜åŒ–æ–‡æ¡ˆ\n   */\n  const optimizeText = async (originalText, options = {}) => {\n    try {\n      const response = await videoApi.optimizeText(originalText, options)\n      return response\n    } catch (error) {\n      console.error('AIä¼˜åŒ–æ–‡æ¡ˆå¤±è´¥:', error)\n      throw error\n    }\n  }\n\n  /**\n   * æ¸…ç†å½“å‰ä»»åŠ¡\n   */\n  const cleanupCurrentTask = async () => {\n    if (currentTask.value) {\n      try {\n        await videoCleaner.cleanCurrentTask()\n        console.log('å·²æ¸…ç†å½“å‰ä»»åŠ¡ç¼“å­˜')\n      } catch (error) {\n        console.warn('æ¸…ç†å½“å‰ä»»åŠ¡å¤±è´¥:', error)\n      }\n    }\n  }\n\n  /**\n   * å–æ¶ˆ/åˆ é™¤ä»»åŠ¡\n   */\n  const cancelTask = async (taskId) => {\n    try {\n      await videoApi.cleanVideo(taskId)\n      \n      // å¦‚æœæ˜¯å½“å‰ä»»åŠ¡ï¼Œæ¸…é™¤çŠ¶æ€\n      if (currentTask.value && currentTask.value.taskId === taskId) {\n        currentTask.value = null\n        videoCleaner.setCurrentTask(null)\n        stopPolling()\n      }\n      \n      // ä»å†å²è®°å½•ä¸­ç§»é™¤\n      removeFromHistory(taskId)\n      \n      // ä»æœ¬åœ°å­˜å‚¨ä¸­ç§»é™¤\n      await removeTaskFromStorage(taskId)\n      \n      return true\n    } catch (error) {\n      console.error('å–æ¶ˆä»»åŠ¡å¤±è´¥:', error)\n      throw error\n    }\n  }\n\n  /**\n   * åˆ é™¤ä»»åŠ¡ï¼ˆå‘åå…¼å®¹ï¼‰\n   */\n  const deleteTask = async (taskId) => {\n    return cancelTask(taskId)\n  }\n\n  /**\n   * é‡è¯•å¤±è´¥ä»»åŠ¡\n   */\n  const retryTask = async (taskId) => {\n    try {\n      const response = await videoApi.retryTask(taskId)\n      \n      // å¦‚æœæ˜¯å½“å‰ä»»åŠ¡ï¼Œå¼€å§‹è½®è¯¢\n      if (currentTask.value && currentTask.value.taskId === taskId) {\n        currentTask.value.status = 'pending'\n        startPolling(taskId)\n      }\n      \n      return response\n    } catch (error) {\n      console.error('é‡è¯•ä»»åŠ¡å¤±è´¥:', error)\n      throw error\n    }\n  }\n\n  /**\n   * é‡ç½®å½“å‰ä»»åŠ¡çŠ¶æ€\n   */\n  const resetCurrentTask = () => {\n    currentTask.value = null\n    transcriptionData.value = null\n    stopPolling()\n    videoCleaner.setCurrentTask(null)\n  }\n\n  /**\n   * è·å–ä»»åŠ¡å†å²è®°å½•\n   */\n  const loadTaskHistory = async () => {\n    try {\n      const history = storage.get('taskHistory', [])\n      taskHistory.value = history\n      return history\n    } catch (error) {\n      console.error('åŠ è½½ä»»åŠ¡å†å²å¤±è´¥:', error)\n      return []\n    }\n  }\n\n  /**\n   * æ¸…é™¤æ‰€æœ‰å†å²è®°å½•\n   */\n  const clearHistory = async () => {\n    try {\n      taskHistory.value = []\n      storage.remove('taskHistory')\n      return true\n    } catch (error) {\n      console.error('æ¸…é™¤å†å²è®°å½•å¤±è´¥:', error)\n      throw error\n    }\n  }\n\n  // è¾…åŠ©æ–¹æ³•\n\n  /**\n   * æ·»åŠ åˆ°å†å²è®°å½•\n   */\n  const addToHistory = (task) => {\n    const existingIndex = taskHistory.value.findIndex(item => item.taskId === task.taskId)\n    \n    if (existingIndex >= 0) {\n      // æ›´æ–°å·²å­˜åœ¨çš„è®°å½•\n      taskHistory.value[existingIndex] = { ...task, updateTime: new Date().toISOString() }\n    } else {\n      // æ·»åŠ æ–°è®°å½•ï¼Œä¿æŒæœ€æ–°çš„åœ¨å‰é¢\n      taskHistory.value.unshift({ ...task, updateTime: new Date().toISOString() })\n      \n      // é™åˆ¶å†å²è®°å½•æ•°é‡\n      if (taskHistory.value.length > 50) {\n        taskHistory.value = taskHistory.value.slice(0, 50)\n      }\n    }\n    \n    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\n    storage.set('taskHistory', taskHistory.value)\n  }\n\n  /**\n   * æ›´æ–°å†å²è®°å½•ä¸­çš„é¡¹ç›®\n   */\n  const updateHistoryItem = (task) => {\n    const index = taskHistory.value.findIndex(item => item.taskId === task.taskId)\n    if (index >= 0) {\n      taskHistory.value[index] = { ...task, updateTime: new Date().toISOString() }\n      \n      // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\n      storage.set('taskHistory', taskHistory.value)\n    }\n  }\n\n  /**\n   * ä»å†å²è®°å½•ä¸­ç§»é™¤\n   */\n  const removeFromHistory = (taskId) => {\n    taskHistory.value = taskHistory.value.filter(item => item.taskId !== taskId)\n    \n    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\n    storage.set('taskHistory', taskHistory.value)\n  }\n\n  /**\n   * ä¿å­˜ä»»åŠ¡åˆ°æœ¬åœ°å­˜å‚¨\n   */\n  const saveTaskToStorage = async (task) => {\n    try {\n      storage.set(`task_${task.taskId}`, task)\n    } catch (error) {\n      console.error('ä¿å­˜ä»»åŠ¡åˆ°æœ¬åœ°å­˜å‚¨å¤±è´¥:', error)\n    }\n  }\n\n  /**\n   * ä»æœ¬åœ°å­˜å‚¨ç§»é™¤ä»»åŠ¡\n   */\n  const removeTaskFromStorage = async (taskId) => {\n    try {\n      storage.remove(`task_${taskId}`)\n    } catch (error) {\n      console.error('ä»æœ¬åœ°å­˜å‚¨ç§»é™¤ä»»åŠ¡å¤±è´¥:', error)\n    }\n  }\n\n  /**\n   * ä»æœ¬åœ°å­˜å‚¨æ¢å¤ä»»åŠ¡\n   */\n  const restoreTaskFromStorage = async (taskId) => {\n    try {\n      const task = storage.get(`task_${taskId}`)\n      if (task) {\n        currentTask.value = task\n        return task\n      }\n      return null\n    } catch (error) {\n      console.error('ä»æœ¬åœ°å­˜å‚¨æ¢å¤ä»»åŠ¡å¤±è´¥:', error)\n      return null\n    }\n  }\n\n  // åˆå§‹åŒ–\n  const initialize = async () => {\n    try {\n      // åŠ è½½å†å²è®°å½•\n      await loadTaskHistory()\n    } catch (error) {\n      console.error('åˆå§‹åŒ–ä»»åŠ¡å­˜å‚¨å¤±è´¥:', error)\n    }\n  }\n\n  // è¿”å›çŠ¶æ€å’Œæ–¹æ³•\n  return {\n    // çŠ¶æ€\n    currentTask,\n    taskHistory,\n    isLoading,\n    isDownloading,\n    transcriptionData,\n    \n    // è®¡ç®—å±æ€§\n    currentProgress,\n    isProcessing,\n    isCompleted,\n    isFailed,\n    isTranscribing,\n    isTranscriptionCompleted,\n    isTranscriptionFailed,\n    \n    // æ–¹æ³•\n    createTask,\n    createUploadTask,\n    refreshTaskStatus,\n    updateTaskStatus,\n    updateCurrentTask,\n    startPolling,\n    stopPolling,\n    downloadVideo,\n    transcribeVideo,\n    getTranscriptionResult,\n    optimizeText,\n    cancelTask,\n    deleteTask,\n    retryTask,\n    loadTaskHistory,\n    clearHistory,\n    restoreTaskFromStorage,\n    initialize,\n    cleanupCurrentTask,\n    resetCurrentTask\n  }\n}) ","/**\n * å‰ªè´´æ¿å·¥å…·å‡½æ•°\n */\n\n/**\n * å¤åˆ¶æ–‡æœ¬åˆ°å‰ªè´´æ¿\n * @param {string} text - è¦å¤åˆ¶çš„æ–‡æœ¬\n * @returns {Promise<boolean>} - å¤åˆ¶æ˜¯å¦æˆåŠŸ\n */\nexport async function copyToClipboard(text) {\n  try {\n    // ä¼˜å…ˆä½¿ç”¨ç°ä»£ Clipboard API\n    if (navigator.clipboard && window.isSecureContext) {\n      await navigator.clipboard.writeText(text)\n      return true\n    }\n    \n    // é™çº§åˆ°ä¼ ç»Ÿæ–¹æ³•\n    const textArea = document.createElement('textarea')\n    textArea.value = text\n    textArea.style.position = 'fixed'\n    textArea.style.opacity = '0'\n    textArea.style.left = '-999999px'\n    textArea.style.top = '-999999px'\n    \n    document.body.appendChild(textArea)\n    textArea.focus()\n    textArea.select()\n    \n    const success = document.execCommand('copy')\n    document.body.removeChild(textArea)\n    \n    return success\n  } catch (error) {\n    console.error('å¤åˆ¶åˆ°å‰ªè´´æ¿å¤±è´¥:', error)\n    return false\n  }\n}\n\n/**\n * ä»å‰ªè´´æ¿è¯»å–æ–‡æœ¬\n * @returns {Promise<string>} - å‰ªè´´æ¿ä¸­çš„æ–‡æœ¬\n */\nexport async function readFromClipboard() {\n  try {\n    // åªæœ‰åœ¨å®‰å…¨ä¸Šä¸‹æ–‡ä¸­æ‰èƒ½ä½¿ç”¨ Clipboard API\n    if (navigator.clipboard && window.isSecureContext) {\n      const text = await navigator.clipboard.readText()\n      return text\n    }\n    \n    // æ— æ³•åœ¨éå®‰å…¨ä¸Šä¸‹æ–‡ä¸­è¯»å–å‰ªè´´æ¿\n    throw new Error('æ— æ³•è¯»å–å‰ªè´´æ¿ï¼šéœ€è¦å®‰å…¨ä¸Šä¸‹æ–‡')\n  } catch (error) {\n    console.error('è¯»å–å‰ªè´´æ¿å¤±è´¥:', error)\n    return ''\n  }\n}\n\n/**\n * æ£€æŸ¥æ˜¯å¦æ”¯æŒå‰ªè´´æ¿æ“ä½œ\n * @returns {boolean} - æ˜¯å¦æ”¯æŒå‰ªè´´æ¿æ“ä½œ\n */\nexport function isClipboardSupported() {\n  return !!(navigator.clipboard && window.isSecureContext)\n}\n\n/**\n * æ£€æŸ¥æ–‡æœ¬æ˜¯å¦å¯èƒ½æ˜¯è§†é¢‘é“¾æ¥\n * @param {string} text - è¦æ£€æŸ¥çš„æ–‡æœ¬\n * @returns {boolean} - æ˜¯å¦å¯èƒ½æ˜¯è§†é¢‘é“¾æ¥\n */\nexport function isPossibleVideoLink(text) {\n  if (!text || typeof text !== 'string') {\n    return false\n  }\n  \n  // å¸¸è§è§†é¢‘å¹³å°åŸŸå\n  const videoPatterns = [\n    /douyin\\.com/i,\n    /dy\\.com/i,\n    /bilibili\\.com/i,\n    /b23\\.tv/i,\n    /youtube\\.com/i,\n    /youtu\\.be/i,\n    /kuaishou\\.com/i,\n    /ixigua\\.com/i,\n    /weibo\\.com/i,\n    /xiaohongshu\\.com/i\n  ]\n  \n  // æ£€æŸ¥æ˜¯å¦åŒ…å«è§†é¢‘å¹³å°åŸŸå\n  return videoPatterns.some(pattern => pattern.test(text))\n}\n\n/**\n * æå–æ–‡æœ¬ä¸­çš„é“¾æ¥\n * @param {string} text - è¦æå–é“¾æ¥çš„æ–‡æœ¬\n * @returns {string[]} - æå–åˆ°çš„é“¾æ¥æ•°ç»„\n */\nexport function extractLinks(text) {\n  if (!text || typeof text !== 'string') {\n    return []\n  }\n  \n  // URLæ­£åˆ™è¡¨è¾¾å¼\n  const urlRegex = /(https?:\\/\\/[^\\s]+)/gi\n  const matches = text.match(urlRegex)\n  \n  return matches || []\n}\n\n/**\n * æ¸…ç†å’Œæ ‡å‡†åŒ–æ–‡æœ¬\n * @param {string} text - è¦æ¸…ç†çš„æ–‡æœ¬\n * @returns {string} - æ¸…ç†åçš„æ–‡æœ¬\n */\nexport function cleanText(text) {\n  if (!text || typeof text !== 'string') {\n    return ''\n  }\n  \n  return text\n    .trim()\n    .replace(/\\s+/g, ' ') // åˆå¹¶å¤šä¸ªç©ºæ ¼\n    .replace(/[\\r\\n]+/g, ' ') // æ¢è¡Œç¬¦è½¬ç©ºæ ¼\n} "],"names":["isDevelopment","API_BASE_URL","api","axios","config","showLoadingToast","_a","error","closeToast","response","data","errorMessage","showToast","status","FFMessageType","FFFSType","maybeCompressForNetlify","inputFile","thresholdBytes","videoApi","url","platform","file","onProgress","MAX_SIZE","supportedTypes","supportedExtensions","fileExtension","uploadFile","enableCompression","thresholdMb","compacted","compressed","compressedKey","e","formData","progressEvent","progress","_c","_b","_d","taskId","params","hours","text","options","trimmedText","MAX_LENGTH","timeout","CHUNK_SIZE","chunks","sentences","currentChunk","i","sentence","optimizedChunks","errors","resolve","optimizedText","interval","maxAttempts","attempts","res","VideoCleaner","shouldClean","cleanUrl","videoCleaner","storage","key","defaultValue","item","value","total","useTaskStore","defineStore","currentTask","ref","taskHistory","isLoading","isDownloading","pollingTimer","transcriptionData","currentProgress","computed","isProcessing","isCompleted","isFailed","isTranscribing","isTranscriptionCompleted","isTranscriptionFailed","createTask","cleanupCurrentTask","saveTaskToStorage","addToHistory","startPolling","createUploadTask","taskForStorage","refreshTaskStatus","taskData","updateHistoryItem","updateTaskStatus","updateCurrentTask","updates","stopPolling","downloadVideo","downloadUrl","link","transcribeVideo","result","getTranscriptionResult","optimizeText","originalText","cancelTask","removeFromHistory","removeTaskFromStorage","deleteTask","retryTask","resetCurrentTask","loadTaskHistory","history","clearHistory","task","existingIndex","index","copyToClipboard","textArea","success","readFromClipboard"],"mappings":"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","x_google_ignoreList":[1,2]}