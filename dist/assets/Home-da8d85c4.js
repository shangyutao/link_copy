import{_ as ue,I as de}from"./index-2ab10388.js";/* empty css              */import{u as ve,v as pe,r as me}from"./clipboard-431328c5.js";/* empty css              */import{K as fe,L as ge,r as n,c as u,a as _e,o as ye,w as ke,B as o,C as m,D as t,E as he,j as d,M as k,N as h,G as x,O as g,P as H,F as R,Q as W,t as C}from"./vendor-194b799d.js";import{s as r,a as be,B as we,F as Te,T as Ie,I as xe,L as Ce}from"./vant-83faff4e.js";import"./utils-917b1704.js";const Pe=v=>{if(!v||typeof v!="string")return!1;try{return new URL(v),!0}catch{return[/douyin\.com/i,/dy\.com/i,/bilibili\.com/i,/b23\.tv/i,/youtube\.com/i,/youtu\.be/i].some(S=>S.test(v))}},Ve=v=>{if(!v)return null;const i=v.toLowerCase();return i.includes("douyin.com")||i.includes("dy.com")?"douyin":i.includes("bilibili.com")||i.includes("b23.tv")?"bilibili":i.includes("youtube.com")||i.includes("youtu.be")?"youtube":i.includes("tiktok.com")?"tiktok":null};const Le={class:"home-page"},Ne={class:"container"},Se={class:"header animate-fade-in-up"},Be={class:"main-content"},Fe={class:"input-section animate-fade-in-up"},Ae={class:"input-card card-floating"},De={class:"input-area"},Me={class:"input-actions"},Ue={key:0,class:"platform-hint"},Ee={key:0,class:"progress-section animate-fade-in-up"},ze={class:"progress-card card-floating"},He={class:"progress-header"},Re={class:"progress-icon"},We={class:"progress-content"},$e={key:0,class:"progress-bar-container"},je={class:"progress-bar"},Ge={class:"progress-text"},Ke={class:"platforms-section animate-fade-in-up"},Oe={class:"platforms-card card-floating"},Qe={class:"platforms-grid"},qe={class:"platform-name"},Je={class:"features-section animate-fade-in-up"},Xe={class:"features-card card-floating"},Ye={class:"features-grid"},Ze={class:"feature-icon"},et={class:"feature-content"},tt={__name:"Home",setup(v){const i=fe(),S=ge(),a=ve(),_=n(""),P=n(""),V=n(!1),B=n(!1),F=n(!1),c=n(0),L=n(null),b=n(null),A=n(!1),w=n("desktop"),y=n(null),T=n(!1),M=u(()=>{const e=_.value||"";return typeof e=="string"&&e.trim().length>0&&Pe(e)}),U=u(()=>N.value||V.value||a.isDownloading),E=u(()=>navigator.clipboard&&window.isSecureContext),$=u(()=>a.currentTask&&a.currentTask.status!=="idle"),N=u(()=>{var e;return["pending","downloading","transcribing"].includes((e=a.currentTask)==null?void 0:e.status)}),j=u(()=>{var e;return((e=a.currentTask)==null?void 0:e.status)==="completed"}),G=u(()=>{var e;return((e=a.currentTask)==null?void 0:e.status)==="failed"}),K=u(()=>{if(!a.currentTask)return"";switch(a.currentTask.status){case"pending":return"任务准备中";case"downloading":return"视频解析中";case"transcribing":return"音频转文案中";case"completed":return"处理完成";case"failed":return"处理失败";default:return""}}),O=u(()=>{if(!a.currentTask)return"";switch(a.currentTask.status){case"pending":return"正在创建下载任务...";case"downloading":return"正在下载视频文件...";case"transcribing":return"正在转换音频为文案...";case"completed":return"所有处理步骤已完成";case"failed":return a.currentTask.errorMessage||"处理过程中出现错误";default:return""}}),D=n([{name:"douyin",displayName:"抖音",icon:"music-o",color:"#000000"},{name:"bilibili",displayName:"哔哩哔哩",icon:"video-o",color:"#fb7299"}]),Q=n([{name:"智能解析",description:"自动识别视频平台，快速解析下载链接",icon:"search"},{name:"高清下载",description:"支持多种分辨率，保证视频质量",icon:"down"},{name:"音频转文案",description:"利用AI技术将视频音频转换为文字",icon:"volume-o"},{name:"文案优化",description:"智能优化文案内容，提升可读性",icon:"edit"}]),z=e=>{const s=String(e||"");_.value=s,P.value=Ve(s)},q=()=>{},J=()=>{},X=async()=>{if(!E.value){r("当前环境不支持剪贴板操作");return}try{B.value=!0;const e=await me();e?(_.value=e,z(e),r("粘贴成功")):r("剪贴板为空")}catch(e){console.error("粘贴失败:",e),r("粘贴失败")}finally{B.value=!1}},Y=async()=>{if(!M.value){r("请输入有效的视频链接");return}try{V.value=!0,c.value=0;const e=String(_.value||"").trim();if(!e)throw new Error("请输入有效的视频链接");await a.createTask(e),ee(),r("任务创建成功")}catch(e){console.error("创建任务失败:",e),r("创建任务失败: "+e.message)}finally{V.value=!1}},Z=async()=>{try{await be({title:"确认取消",message:"确定要取消当前任务吗？"}),F.value=!0,await a.cancelTask(),I(),r("任务已取消")}catch(e){e!=="cancel"&&(console.error("取消任务失败:",e),r("取消任务失败"))}finally{F.value=!1}},ee=()=>{b.value||(te(),b.value=setInterval(async()=>{var e;if(!((e=a.currentTask)!=null&&e.taskId)){I();return}try{await a.updateTaskStatus(),["completed","failed"].includes(a.currentTask.status)&&(I(),a.currentTask.status==="completed"&&(c.value=100,setTimeout(()=>{i.push(`/preview/${a.currentTask.taskId}`)},500)))}catch(s){console.error("轮询状态失败:",s)}},5e3))},te=()=>{c.value=0,L.value=setInterval(()=>{if(c.value<99){const e=Math.max(.5,(99-c.value)*.1);c.value=Math.min(99,c.value+e)}},200)},se=()=>{L.value&&(clearInterval(L.value),L.value=null)},I=()=>{b.value&&(clearInterval(b.value),b.value=null),se()},ae=()=>{const e=navigator.userAgent.toLowerCase();/iphone|ipad|ipod/.test(e)?w.value="ios":/android/.test(e)?w.value="android":w.value="desktop"},ne=async()=>{if(console.log("🎯 用户点击安装按钮"),console.log("设备类型:",w.value),console.log("是否支持自动安装:",T.value),T.value&&w.value==="android"&&y.value)try{console.log("🚀 尝试一键安装"),y.value.prompt();const{outcome:e}=await y.value.userChoice;if(console.log("用户选择:",e),e==="accepted"){console.log("✅ 用户接受了安装"),r({message:"安装成功！请在桌面查看应用",type:"success",duration:3e3});return}else console.log("❌ 用户拒绝了安装");y.value=null,T.value=!1}catch(e){console.error("一键安装失败:",e)}console.log("📱 显示安装指引"),A.value=!0},oe=e=>{const s=D.value.find(p=>p.name===e);return(s==null?void 0:s.icon)||"play-circle"},le=e=>{const s=D.value.find(p=>p.name===e);return(s==null?void 0:s.displayName)||e};return _e(()=>{var e;(e=a.currentTask)!=null&&e.taskId&&(console.log("页面刷新，清理之前的任务:",a.currentTask.taskId),pe.cleanTask(a.currentTask.taskId)),ae(),window.addEventListener("beforeinstallprompt",s=>{console.log("🎯 检测到PWA安装提示事件"),s.preventDefault(),y.value=s,T.value=!0,console.log("✅ 支持一键安装功能")}),window.addEventListener("appinstalled",()=>{console.log("🎉 PWA安装完成"),y.value=null,T.value=!1,r({message:"应用安装成功！",type:"success",duration:3e3})})}),ye(()=>{I()}),ke(()=>S.path,()=>{I()}),(e,s)=>{const p=we,re=Te,f=xe,ie=Ie,ce=Ce;return o(),m("div",Le,[s[10]||(s[10]=t("div",{class:"bg-decoration"},[t("div",{class:"decoration-circle circle-1"}),t("div",{class:"decoration-circle circle-2"}),t("div",{class:"decoration-circle circle-3"})],-1)),t("div",Ne,[t("header",Se,[s[3]||(s[3]=he('<div class="logo" data-v-d92c7564><div class="logo-icon glow-effect" data-v-d92c7564><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-d92c7564><path d="M12 2L2 7v10c0 5.55 3.84 9.74 9 11 5.16-1.26 9-5.45 9-11V7l-10-5z" stroke="currentColor" stroke-width="1.5" fill="none" data-v-d92c7564></path><path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="1.5" fill="none" data-v-d92c7564></path></svg></div><div class="logo-text" data-v-d92c7564><h1 class="gradient-text" data-v-d92c7564>Link Copy</h1><p data-v-d92c7564>智能视频解析与文案提取</p></div></div>',1)),d(p,{class:"install-btn btn-glass",icon:"wap-home-o",onClick:ne},{default:k(()=>s[2]||(s[2]=[C(" 添加到桌面 ")])),_:1,__:[2]})]),t("main",Be,[t("div",Fe,[t("div",Ae,[s[6]||(s[6]=t("div",{class:"input-header"},[t("h2",null,"粘贴视频链接"),t("p",null,"支持抖音、哔哩哔哩等主流视频平台")],-1)),t("div",De,[d(re,{modelValue:_.value,"onUpdate:modelValue":[s[0]||(s[0]=l=>_.value=l),z],type:"textarea",placeholder:"在此粘贴视频链接或分享文本...",rows:"3",maxlength:"2000",disabled:U.value,class:"url-input",onFocus:q,onBlur:J},null,8,["modelValue","disabled"]),t("div",Me,[E.value?(o(),h(p,{key:0,class:"paste-btn btn-glass",icon:"add-o",onClick:X,loading:B.value},{default:k(()=>s[4]||(s[4]=[C(" 粘贴 ")])),_:1,__:[4]},8,["loading"])):x("",!0),d(p,{type:"primary",class:"submit-btn btn-primary",loading:V.value,disabled:!M.value||U.value,onClick:Y},{icon:k(()=>[d(f,{name:"play-circle"})]),default:k(()=>[s[5]||(s[5]=C(" 开始解析 "))]),_:1,__:[5]},8,["loading","disabled"])])]),P.value?(o(),m("div",Ue,[d(ie,{type:"primary",class:"platform-tag"},{default:k(()=>[d(f,{name:oe(P.value)},null,8,["name"]),C(" 检测到："+g(le(P.value)),1)]),_:1})])):x("",!0)])]),$.value?(o(),m("div",Ee,[t("div",ze,[t("div",He,[t("div",Re,[N.value?(o(),h(ce,{key:0,size:"24px",color:"#667eea"})):j.value?(o(),h(f,{key:1,name:"success",color:"#10b981"})):G.value?(o(),h(f,{key:2,name:"cross",color:"#ef4444"})):(o(),h(f,{key:3,name:"clock-o",color:"#f59e0b"}))]),t("div",We,[t("h3",null,g(K.value),1),t("p",null,g(O.value),1)]),N.value?(o(),h(p,{key:0,size:"small",type:"danger",plain:"",onClick:Z,loading:F.value},{default:k(()=>s[7]||(s[7]=[C(" 取消 ")])),_:1,__:[7]},8,["loading"])):x("",!0)]),N.value?(o(),m("div",$e,[t("div",je,[t("div",{class:"progress-fill",style:H({width:c.value+"%"})},null,4)]),t("span",Ge,g(Math.round(c.value))+"%",1)])):x("",!0)])])):x("",!0),t("div",Ke,[t("div",Oe,[s[8]||(s[8]=t("div",{class:"platforms-header"},[t("h3",null,"支持平台"),t("p",null,"持续扩展中，更多平台即将支持")],-1)),t("div",Qe,[(o(!0),m(R,null,W(D.value,l=>(o(),m("div",{key:l.name,class:"platform-item"},[t("div",{class:"platform-icon",style:H({color:l.color})},[d(f,{name:l.icon},null,8,["name"])],4),t("span",qe,g(l.displayName),1)]))),128))])])]),t("div",Je,[t("div",Xe,[s[9]||(s[9]=t("div",{class:"features-header"},[t("h3",null,"功能特性"),t("p",null,"强大的视频处理能力，一站式解决方案")],-1)),t("div",Ye,[(o(!0),m(R,null,W(Q.value,l=>(o(),m("div",{key:l.name,class:"feature-item"},[t("div",Ze,[d(f,{name:l.icon},null,8,["name"])]),t("div",et,[t("h4",null,g(l.name),1),t("p",null,g(l.description),1)])]))),128))])])])])]),d(de,{modelValue:A.value,"onUpdate:modelValue":s[1]||(s[1]=l=>A.value=l)},null,8,["modelValue"])])}}},ct=ue(tt,[["__scopeId","data-v-d92c7564"]]);export{ct as default};
//# sourceMappingURL=Home-da8d85c4.js.map
